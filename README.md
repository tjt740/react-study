# react-study-demoå­¦ä¹ reactçš„é¡¹ç›® ğŸ˜±ğŸ™ˆ

# ReactåŸºç¡€

## Reactä»‹ç»

`ç›®æ ‡ä»»åŠ¡:`  äº†è§£ä»€ä¹ˆæ˜¯Reactä»¥åŠå®ƒçš„ç‰¹ç‚¹

**Reactæ˜¯ä»€ä¹ˆ**

â€‹     ä¸€ä¸ªä¸“æ³¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ï¼Œå’Œvueå’Œangularå¹¶ç§°å‰ç«¯ä¸‰å¤§æ¡†æ¶ï¼Œä¸å¤¸å¼ çš„è¯´ï¼Œreactå¼•é¢†äº†å¾ˆå¤šæ–°æ€æƒ³ï¼Œä¸–ç•ŒèŒƒå›´å†…æ˜¯æœ€æµè¡Œçš„jså‰ç«¯æ¡†æ¶

â€‹	Reactè‹±æ–‡æ–‡æ¡£ï¼ˆhttps://reactjs.org/ï¼‰

â€‹	Reactä¸­æ–‡æ–‡æ¡£ ï¼ˆhttps://zh-hans.reactjs.org/ï¼‰

â€‹	Reactæ–°æ–‡æ¡£	ï¼ˆhttps://beta.reactjs.org/ï¼‰ï¼ˆå¼€å‘ä¸­....ï¼‰

**Reactæœ‰ä»€ä¹ˆç‰¹ç‚¹**

1. å£°æ˜å¼UIï¼ˆJSXï¼‰

   å†™UIå°±å’Œå†™æ™®é€šçš„HTMLä¸€æ ·ï¼ŒæŠ›å¼ƒå‘½ä»¤å¼çš„ç¹çå®ç°

   ![](assets/compare.png)

2. ç»„ä»¶åŒ–

   ç»„ä»¶æ˜¯reactä¸­æœ€é‡è¦çš„å†…å®¹ï¼Œç»„ä»¶å¯ä»¥é€šè¿‡æ­ç§¯æœ¨çš„æ–¹å¼æ‹¼æˆä¸€ä¸ªå®Œæ•´çš„é¡µé¢ï¼Œé€šè¿‡ç»„ä»¶çš„æŠ½è±¡å¯ä»¥å¢åŠ å¤ç”¨èƒ½åŠ›å’Œæé«˜å¯ç»´æŠ¤æ€§

   

3. ä¸€æ¬¡å­¦ä¹ ï¼ŒçŸ¿å¹³å°ç¼–å†™

   reactæ—¢å¯ä»¥å¼€å‘webåº”ç”¨ä¹Ÿå¯ä»¥ä½¿ç”¨åŒæ ·çš„è¯­æ³•å¼€å‘åŸç”Ÿåº”ç”¨ï¼ˆreact-nativeï¼‰ï¼Œæ¯”å¦‚å®‰å“å’Œiosåº”ç”¨ï¼Œç”šè‡³å¯ä»¥ä½¿ç”¨reactå¼€å‘VRåº”ç”¨ï¼Œæƒ³è±¡åŠ›ç©ºé—´åè¶³ï¼Œreactæ›´åƒæ˜¯ä¸€ä¸ª `å…ƒæ¡†æ¶`  ä¸ºå„ç§é¢†åŸŸèµ‹èƒ½

   
   
   

## é¡¹ç›®åˆå§‹åŒ–

`ç›®æ ‡ä»»åŠ¡:`   èƒ½å¤Ÿç‹¬ç«‹ä½¿ç”¨Reactè„šæ‰‹æ¶åˆ›å»ºä¸€ä¸ªreacté¡¹ç›®

### 1. ä½¿ç”¨è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®

![](assets/create-react.png)

- æ‰“å¼€å‘½ä»¤è¡Œçª—å£

- æ‰§è¡Œå‘½ä»¤

  ```bash
  npx create-react-app react-basic
  ```

  è¯´æ˜ï¼š

  1. npx create-react-app æ˜¯å›ºå®šå‘½ä»¤ï¼Œ`create-react-app`æ˜¯Reactè„šæ‰‹æ¶çš„åç§°
  2. react-basicè¡¨ç¤ºé¡¹ç›®åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼Œä¿æŒè¯­ä¹‰åŒ–
  3. npx å‘½ä»¤ä¼šå¸®åŠ©æˆ‘ä»¬ä¸´æ—¶å®‰è£…create-react-appåŒ…ï¼Œç„¶ååˆå§‹åŒ–é¡¹ç›®å®Œæˆä¹‹åä¼šè‡ªè‡ªåŠ¨åˆ æ‰ï¼Œæ‰€ä»¥ä¸éœ€è¦å…¨å±€å®‰è£…create-react-app

- å¯åŠ¨é¡¹ç›®

  ```bash
  yarn start
  or
  npm start
  ```

### 2. é¡¹ç›®ç›®å½•è¯´æ˜è°ƒæ•´

- ç›®å½•è¯´æ˜

  1. `src` ç›®å½•æ˜¯æˆ‘ä»¬å†™ä»£ç è¿›è¡Œé¡¹ç›®å¼€å‘çš„ç›®å½•

  2. `package.json`  ä¸­ä¿©ä¸ªæ ¸å¿ƒåº“ï¼šreact ã€react-dom

- ç›®å½•è°ƒæ•´

  1. åˆ é™¤srcç›®å½•ä¸‹è‡ªå¸¦çš„æ‰€æœ‰æ–‡ä»¶ï¼Œåªä¿ç•™app.jsæ ¹ç»„ä»¶å’Œindex.js
  2. åˆ›å»ºindex.jsæ–‡ä»¶ä½œä¸ºé¡¹ç›®çš„å…¥å£æ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ä¹¦å†™reactä»£ç å³å¯
  
- å…¥å£æ–‡ä»¶è¯´æ˜

  ```jsx
  import React from 'react'
  import ReactDOM from 'react-dom'
  import './index.css'
  // å¼•å…¥æ ¹ç»„ä»¶App
  import App from './App'
  // é€šè¿‡è°ƒç”¨ReactDOMçš„renderæ–¹æ³•æ¸²æŸ“Appæ ¹ç»„ä»¶åˆ°idä¸ºrootçš„domèŠ‚ç‚¹ä¸Š
  ReactDOM.render(
    <React.StrictMode>
      <App />
    </React.StrictMode>,
    document.getElementById('root')
  )
  ```

## JSXåŸºç¡€

### 1. JSXä»‹ç»

`ç›®æ ‡ä»»åŠ¡:`   èƒ½å¤Ÿç†è§£ä»€ä¹ˆæ˜¯JSXï¼ŒJSXçš„åº•å±‚æ˜¯ä»€ä¹ˆ

æ¦‚å¿µï¼šJSXæ˜¯ JavaScript XMLï¼ˆHTMLï¼‰çš„ç¼©å†™ï¼Œè¡¨ç¤ºåœ¨ JS ä»£ç ä¸­ä¹¦å†™ HTML ç»“æ„

ä½œç”¨ï¼šåœ¨Reactä¸­åˆ›å»ºHTMLç»“æ„ï¼ˆé¡µé¢UIç»“æ„ï¼‰

ä¼˜åŠ¿ï¼š

1. é‡‡ç”¨ç±»ä¼¼äºHTMLçš„è¯­æ³•ï¼Œé™ä½å­¦ä¹ æˆæœ¬ï¼Œä¼šHTMLå°±ä¼šJSX
2. å……åˆ†åˆ©ç”¨JSè‡ªèº«çš„å¯ç¼–ç¨‹èƒ½åŠ›åˆ›å»ºHTMLç»“æ„

æ³¨æ„ï¼šJSX å¹¶ä¸æ˜¯æ ‡å‡†çš„ JS è¯­æ³•ï¼Œæ˜¯ JS çš„è¯­æ³•æ‰©å±•ï¼Œæµè§ˆå™¨é»˜è®¤æ˜¯ä¸è¯†åˆ«çš„ï¼Œè„šæ‰‹æ¶ä¸­å†…ç½®çš„ [@babel/plugin-transform-react-jsx](@babel/plugin-transform-react-jsx) åŒ…ï¼Œç”¨æ¥è§£æè¯¥è¯­æ³•

![](assets/jsx02.png)





### 2. JSXä¸­ä½¿ç”¨jsè¡¨è¾¾å¼

`ç›®æ ‡ä»»åŠ¡:`   èƒ½å¤Ÿåœ¨JSXä¸­ä½¿ç”¨è¡¨è¾¾å¼

**è¯­æ³•**

`{ JS è¡¨è¾¾å¼ }`

```jsx
const name = 'æŸ´æŸ´'

<h1>ä½ å¥½ï¼Œæˆ‘å«{name}</h1>   //    <h1>ä½ å¥½,æˆ‘å«æŸ´æŸ´</h1>
```

**å¯ä»¥ä½¿ç”¨çš„è¡¨è¾¾å¼**

1. å­—ç¬¦ä¸²ã€æ•°å€¼ã€å¸ƒå°”å€¼ã€nullã€undefinedã€objectï¼ˆ [] / {} ï¼‰
2. 1 + 2ã€'abc'.split('')ã€['a', 'b'].join('-')
3. fn()

**ç‰¹åˆ«æ³¨æ„**

â€‹	if è¯­å¥/ switch-case è¯­å¥/ å˜é‡å£°æ˜è¯­å¥ï¼Œè¿™äº›å«åšè¯­å¥ï¼Œä¸æ˜¯è¡¨è¾¾å¼ï¼Œä¸èƒ½å‡ºç°åœ¨ `{}` ä¸­ï¼ï¼

### 3. JSXåˆ—è¡¨æ¸²æŸ“

`ç›®æ ‡ä»»åŠ¡:`   èƒ½å¤Ÿåœ¨JSXä¸­å®ç°åˆ—è¡¨æ¸²æŸ“

> é¡µé¢çš„æ„å»ºç¦»ä¸å¼€é‡å¤çš„åˆ—è¡¨ç»“æ„ï¼Œæ¯”å¦‚æ­Œæ›²åˆ—è¡¨ï¼Œå•†å“åˆ—è¡¨ç­‰ï¼Œæˆ‘ä»¬çŸ¥é“vueä¸­ç”¨çš„æ˜¯v-forï¼Œreactè¿™è¾¹å¦‚ä½•å®ç°å‘¢ï¼Ÿ

å®ç°ï¼šä½¿ç”¨æ•°ç»„çš„`map` æ–¹æ³•

æ¡ˆä¾‹ï¼š

```jsx
// æ¥ä¸ªåˆ—è¡¨
const songs = [
  { id: 1, name: 'ç—´å¿ƒç»å¯¹' },
  { id: 2, name: 'åƒæˆ‘è¿™æ ·çš„äºº' },
  { id: 3, name: 'å—å±±å—' }
]

function App() {
  return (
    <div className="App">
      <ul>
        {
          songs.map(item => <li>{item.name}</li>)
        }
      </ul>
    </div>
  )
}

export default App
```

æ³¨æ„ç‚¹ï¼šéœ€è¦ä¸ºéå†é¡¹æ·»åŠ  `key` å±æ€§

![](assets/jsx03.png)

1. key åœ¨ HTML ç»“æ„ä¸­æ˜¯çœ‹ä¸åˆ°çš„ï¼Œæ˜¯ React å†…éƒ¨ç”¨æ¥è¿›è¡Œæ€§èƒ½ä¼˜åŒ–æ—¶ä½¿ç”¨
2. key åœ¨å½“å‰åˆ—è¡¨ä¸­è¦å”¯ä¸€çš„å­—ç¬¦ä¸²æˆ–è€…æ•°å€¼ï¼ˆString/Numberï¼‰
3. å¦‚æœåˆ—è¡¨ä¸­æœ‰åƒ id è¿™ç§çš„å”¯ä¸€å€¼ï¼Œå°±ç”¨ id æ¥ä½œä¸º key å€¼
4. å¦‚æœåˆ—è¡¨ä¸­æ²¡æœ‰åƒ id è¿™ç§çš„å”¯ä¸€å€¼ï¼Œå°±å¯ä»¥ä½¿ç”¨ indexï¼ˆä¸‹æ ‡ï¼‰æ¥ä½œä¸º key å€¼

### 4. JSXæ¡ä»¶æ¸²æŸ“

`ç›®æ ‡ä»»åŠ¡:`   èƒ½å¤Ÿåœ¨JSXä¸­å®ç°æ¡ä»¶æ¸²æŸ“

ä½œç”¨ï¼šæ ¹æ®æ˜¯å¦æ»¡è¶³æ¡ä»¶ç”ŸæˆHTMLç»“æ„ï¼Œæ¯”å¦‚Loadingæ•ˆæœ

å®ç°ï¼šå¯ä»¥ä½¿ç”¨ `ä¸‰å…ƒè¿ç®—ç¬¦` æˆ–   `é€»è¾‘ä¸(&&)è¿ç®—ç¬¦`

æ¡ˆä¾‹ï¼š

```jsx
// æ¥ä¸ªå¸ƒå°”å€¼
const flag = true
function App() {
  return (
    <div className="App">
      {/* æ¡ä»¶æ¸²æŸ“å­—ç¬¦ä¸² */}
      {flag ? 'reactçœŸæœ‰è¶£' : 'vueçœŸæœ‰è¶£'}
      {/* æ¡ä»¶æ¸²æŸ“æ ‡ç­¾/ç»„ä»¶ */}
      {flag ? <span>this is span</span> : null}
    </div>
  )
}
export default App
```



### 5. JSXæ ·å¼å¤„ç†

`ç›®æ ‡ä»»åŠ¡:`   èƒ½å¤Ÿåœ¨JSXä¸­å®ç°cssæ ·å¼å¤„ç†

- è¡Œå†…æ ·å¼ - style

  ```jsx
  function App() {
    return (
      <div className="App">
        <div style={{ color: 'red' }}>this is a div</div>
      </div>
    )
  }
  
  export default App
  ```

- è¡Œå†…æ ·å¼ - style - æ›´ä¼˜å†™æ³•

  ```jsx
  const styleObj = {
      color:red
  }
  
  function App() {
    return (
      <div className="App">
        <div style={ styleObj }>this is a div</div>
      </div>
    )
  }
  
  export default App
  ```

  

- ç±»å - classNameï¼ˆæ¨èï¼‰

  `app.css`

  ```css
  .title {
    font-size: 30px;
    color: blue;
  }
  ```

  `app.js`

  ```jsx
  import './app.css'
  
  function App() {
    return (
      <div className="App">
        <div className='title'>this is a div</div>
      </div>
    )
  }
  export default App
  ```
  
- ç±»å - className - åŠ¨æ€ç±»åæ§åˆ¶

  ```jsx
  import './app.css'
  const showTitle = true
  function App() {
    return (
      <div className="App">
        <div className={ showTitle ? 'title' : ''}>this is a div</div>
      </div>
    )
  }
  export default App
  ```

### 6. JSXæ³¨æ„äº‹é¡¹

`ç›®æ ‡ä»»åŠ¡:`   æŒæ¡JSXåœ¨å®é™…åº”ç”¨æ—¶çš„æ³¨æ„äº‹é¡¹

1. JSXå¿…é¡»æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰æ ¹èŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨`<></>`ï¼ˆå¹½çµèŠ‚ç‚¹ï¼‰æ›¿ä»£
2. æ‰€æœ‰æ ‡ç­¾å¿…é¡»å½¢æˆé—­åˆï¼Œæˆå¯¹é—­åˆæˆ–è€…è‡ªé—­åˆéƒ½å¯ä»¥
3. JSXä¸­çš„è¯­æ³•æ›´åŠ è´´è¿‘JSè¯­æ³•ï¼Œå±æ€§åé‡‡ç”¨é©¼å³°å‘½åæ³•  `class -> className`  `for -> htmlFor`
4. JSXæ”¯æŒå¤šè¡Œï¼ˆæ¢è¡Œï¼‰ï¼Œå¦‚æœéœ€è¦æ¢è¡Œï¼Œéœ€ä½¿ç”¨`()` åŒ…è£¹ï¼Œé˜²æ­¢bugå‡ºç°



## æ ¼å¼åŒ–é…ç½®

`ç›®æ ‡ä»»åŠ¡:`   åŸºäºvscodeé…ç½®æ ¼å¼åŒ–å·¥å…·ï¼Œæé«˜å¼€å‘æ•ˆç‡

1. å®‰è£…vsCode prettieræ’ä»¶

2. ä¿®æ”¹é…ç½®æ–‡ä»¶ `setting.json`

   ```json
   {
     "git.enableSmartCommit": true,
     // ä¿®æ”¹æ³¨é‡Šé¢œè‰²
     "editor.tokenColorCustomizations": {
       "comments": {
         "fontStyle": "bold",
         "foreground": "#82e0aa"
       }
     },
     // é…ç½®æ–‡ä»¶ç±»å‹è¯†åˆ«
     "files.associations": {
       "*.js": "javascript",
       "*.json": "jsonc",
       "*.cjson": "jsonc",
       "*.wxss": "css",
       "*.wxs": "javascript"
     },
     "extensions.ignoreRecommendations": false,
     "files.exclude": {
       "**/.DS_Store": true,
       "**/.git": true,
       "**/.hg": true,
       "**/.svn": true,
       "**/CVS": true,
       "**/node_modules": false,
       "**/tmp": true
     },
     // "javascript.implicitProjectConfig.experimentalDecorators": true,
     "explorer.confirmDragAndDrop": false,
     "typescript.updateImportsOnFileMove.enabled": "prompt",
     "git.confirmSync": false,
     "editor.tabSize": 2,
     "editor.fontWeight": "500",
     "[json]": {},
     "editor.tabCompletion": "on",
     "vsicons.projectDetection.autoReload": true,
     "editor.fontFamily": "Monaco, 'Courier New', monospace, Meslo LG M for Powerline",
     "[html]": {
       "editor.defaultFormatter": "vscode.html-language-features"
     },
     "editor.fontSize": 16,
     "debug.console.fontSize": 14,
     "vsicons.dontShowNewVersionMessage": true,
     "editor.minimap.enabled": true,
     "emmet.extensionsPath": [
       ""
     ],
     // vue eslint start ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç 
     "editor.formatOnSave": true,
     // eslinté…ç½®é¡¹ï¼Œä¿å­˜æ—¶è‡ªåŠ¨ä¿®å¤é”™è¯¯
     "editor.codeActionsOnSave": {
       "source.fixAll": true
     },
     "vetur.ignoreProjectWarning": true,
     // è®©veturä½¿ç”¨vsè‡ªå¸¦çš„jsæ ¼å¼åŒ–å·¥å…·
     // uni-appå’Œvue é¡¹ç›®ä½¿ç”¨
     "vetur.format.defaultFormatter.js": "vscode-typescript",
     "javascript.format.semicolons": "remove",
     // // æŒ‡å®š *.vue æ–‡ä»¶çš„æ ¼å¼åŒ–å·¥å…·ä¸ºvetur
     "[vue]": {
       "editor.defaultFormatter": "octref.vetur"
     },
     // // æŒ‡å®š *.js æ–‡ä»¶çš„æ ¼å¼åŒ–å·¥å…·ä¸ºvscodeè‡ªå¸¦
     "[javascript]": {
       "editor.defaultFormatter": "vscode.typescript-language-features"
     },
     // // é»˜è®¤ä½¿ç”¨prettieræ ¼å¼åŒ–æ”¯æŒçš„æ–‡ä»¶
     "editor.defaultFormatter": "esbenp.prettier-vscode",
     "prettier.jsxBracketSameLine": true,
     // å‡½æ•°å‰é¢åŠ ä¸ªç©ºæ ¼
     "javascript.format.insertSpaceBeforeFunctionParenthesis": true,
     "prettier.singleQuote": true,
     "prettier.semi": false,
     // eslint end
     // react
     // å½“æŒ‰tabé”®çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æç¤º
     "emmet.triggerExpansionOnTab": true,
     "emmet.showAbbreviationSuggestions": true,
     "emmet.includeLanguages": {
       // jsxçš„æç¤º
       "javascript": "javascriptreact",
       "vue-html": "html",
       "vue": "html",
       "wxml": "html"
     },
     // end
     "[jsonc]": {
       "editor.defaultFormatter": "vscode.json-language-features"
     },
     // @è·¯å¾„æç¤º
     "path-intellisense.mappings": {
       "@": "${workspaceRoot}/src"
     },
     "security.workspace.trust.untrustedFiles": "open",
     "git.ignoreMissingGitWarning": true,
     "window.zoomLevel": 1
   }
   ```
   
   

## é˜¶æ®µå°ç»ƒä¹ 

![](assets/jsx-demo.png)

ç»ƒä¹ è¯´æ˜

1. æ‹‰å–å‡†å¤‡å¥½çš„é¡¹ç›®æ¨¡å—åˆ°æœ¬åœ° ï¼Œå®‰è£…ä¾èµ–ï¼Œrunèµ·æ¥é¡¹ç›®

   https://gitee.com/react-course-series/react-jsx-demo

2. æŒ‰ç…§å›¾ç¤ºï¼Œå®Œæˆ `è¯„è®ºæ•°æ®æ¸²æŸ“`  `tabå†…å®¹æ¸²æŸ“`  `è¯„è®ºåˆ—è¡¨ç‚¹èµå’Œç‚¹è¸©`  ä¸‰ä¸ªè§†å›¾æ¸²æŸ“



# Reactç»„ä»¶åŸºç¡€

## ç»„ä»¶æ¦‚å¿µ

![](assets/components.png)

## å‡½æ•°ç»„ä»¶

`ç›®æ ‡ä»»åŠ¡:`   èƒ½å¤Ÿç‹¬ç«‹ä½¿ç”¨å‡½æ•°å®Œæˆreactç»„ä»¶çš„åˆ›å»ºå’Œæ¸²æŸ“

**æ¦‚å¿µ**

> ä½¿ç”¨ JS çš„å‡½æ•°ï¼ˆæˆ–ç®­å¤´å‡½æ•°ï¼‰åˆ›å»ºçš„ç»„ä»¶ï¼Œå°±å«åš`å‡½æ•°ç»„ä»¶`

**ç»„ä»¶å®šä¹‰ä¸æ¸²æŸ“**

```jsx
// å®šä¹‰å‡½æ•°ç»„ä»¶
function HelloFn () {
  return <div>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªå‡½æ•°ç»„ä»¶!</div>
}

// å®šä¹‰ç±»ç»„ä»¶
function App () {
  return (
    <div className="App">
      {/* æ¸²æŸ“å‡½æ•°ç»„ä»¶ */}
      <HelloFn />
      <HelloFn></HelloFn>
    </div>
  )
}
export default App
```

**çº¦å®šè¯´æ˜**

1. ç»„ä»¶çš„åç§°**å¿…é¡»é¦–å­—æ¯å¤§å†™**ï¼Œreactå†…éƒ¨ä¼šæ ¹æ®è¿™ä¸ªæ¥åˆ¤æ–­æ˜¯ç»„ä»¶è¿˜æ˜¯æ™®é€šçš„HTMLæ ‡ç­¾
2. å‡½æ•°ç»„ä»¶**å¿…é¡»æœ‰è¿”å›å€¼**ï¼Œè¡¨ç¤ºè¯¥ç»„ä»¶çš„ UI ç»“æ„ï¼›å¦‚æœä¸éœ€è¦æ¸²æŸ“ä»»ä½•å†…å®¹ï¼Œåˆ™è¿”å› null

3. ç»„ä»¶å°±åƒ HTML æ ‡ç­¾ä¸€æ ·å¯ä»¥è¢«æ¸²æŸ“åˆ°é¡µé¢ä¸­ã€‚ç»„ä»¶è¡¨ç¤ºçš„æ˜¯ä¸€æ®µç»“æ„å†…å®¹ï¼Œå¯¹äºå‡½æ•°ç»„ä»¶æ¥è¯´ï¼Œæ¸²æŸ“çš„å†…å®¹æ˜¯å‡½æ•°çš„**è¿”å›å€¼**å°±æ˜¯å¯¹åº”çš„å†…å®¹
4. ä½¿ç”¨å‡½æ•°åç§°ä½œä¸ºç»„ä»¶æ ‡ç­¾åç§°ï¼Œå¯ä»¥æˆå¯¹å‡ºç°ä¹Ÿå¯ä»¥è‡ªé—­åˆ

## ç±»ç»„ä»¶

`ç›®æ ‡ä»»åŠ¡:`   èƒ½å¤Ÿç‹¬ç«‹å®Œæˆç±»ç»„ä»¶çš„åˆ›å»ºå’Œæ¸²æŸ“

> ä½¿ç”¨ ES6 çš„ class åˆ›å»ºçš„ç»„ä»¶ï¼Œå«åšç±»ï¼ˆclassï¼‰ç»„ä»¶

**ç»„ä»¶å®šä¹‰ä¸æ¸²æŸ“**

```jsx
// å¼•å…¥React
import React from 'react'

// å®šä¹‰ç±»ç»„ä»¶
class HelloC extends React.Component {
  render () {
    return <div>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªç±»ç»„ä»¶!</div>
  }
}

function App () {
  return (
    <div className="App">
      {/* æ¸²æŸ“ç±»ç»„ä»¶ */}
      <HelloC />
      <HelloC></HelloC>
    </div>
  )
}
export default App
```

**çº¦å®šè¯´æ˜**

1. **ç±»åç§°ä¹Ÿå¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´**

2. ç±»ç»„ä»¶åº”è¯¥ç»§æ‰¿ React.Component çˆ¶ç±»ï¼Œä»è€Œä½¿ç”¨çˆ¶ç±»ä¸­æä¾›çš„æ–¹æ³•æˆ–å±æ€§ 

3. ç±»ç»„ä»¶å¿…é¡»æä¾› render æ–¹æ³•**render æ–¹æ³•å¿…é¡»æœ‰è¿”å›å€¼ï¼Œè¡¨ç¤ºè¯¥ç»„ä»¶çš„ UI ç»“æ„**


## äº‹ä»¶ç»‘å®š

`ç›®æ ‡ä»»åŠ¡:`   èƒ½å¤Ÿç‹¬ç«‹ç»‘å®šä»»ä½•äº‹ä»¶å¹¶èƒ½è·å–åˆ°äº‹ä»¶å¯¹è±¡e

### 1. å¦‚ä½•ç»‘å®šäº‹ä»¶

- è¯­æ³•    

  on + äº‹ä»¶åç§° = { äº‹ä»¶å¤„ç†ç¨‹åº } ï¼Œæ¯”å¦‚ï¼š`<div onClick={()=>{}}></div>`

- æ³¨æ„ç‚¹

  reactäº‹ä»¶é‡‡ç”¨é©¼å³°å‘½åæ³•ï¼Œæ¯”å¦‚ï¼šonMouseEnterã€onFocus

- æ ·ä¾‹

  ```jsx
  // å‡½æ•°ç»„ä»¶
  function HelloFn () {
    // å®šä¹‰äº‹ä»¶å›è°ƒå‡½æ•°
    const clickHandler = () => {
      console.log('äº‹ä»¶è¢«è§¦å‘äº†')
    }
    return (
      // ç»‘å®šäº‹ä»¶
      <button onClick={clickHandler}>click me!</button>
    )
  }
  
  // ç±»ç»„ä»¶
  class HelloC extends React.Component {
    // å®šä¹‰äº‹ä»¶å›è°ƒå‡½æ•°
    clickHandler = () => {
      console.log('äº‹ä»¶è¢«è§¦å‘äº†')
    }
    render () {
      return (
        // ç»‘å®šäº‹ä»¶
        <button onClick={this.clickHandler}>click me!</button>
      )
    }
  }
  ```

### 2. è·å–äº‹ä»¶å¯¹è±¡

- é€šè¿‡äº‹ä»¶å¤„ç†ç¨‹åºçš„å‚æ•°è·å–äº‹ä»¶å¯¹è±¡e

  ```jsx
  // å‡½æ•°ç»„ä»¶
  function HelloFn () {
    // å®šä¹‰äº‹ä»¶å›è°ƒå‡½æ•°
    const clickHandler = (e) => {
      e.preventDefault()
      console.log('äº‹ä»¶è¢«è§¦å‘äº†', e)
    }
    return (
      // ç»‘å®šäº‹ä»¶
      <a href="http://itcast.cn/" onClick={clickHandler}>ä¼ æ™ºæ’­å®¢</a>
    )
  }
  ```


## ç»„ä»¶çŠ¶æ€

`ç›®æ ‡ä»»åŠ¡:`   èƒ½å¤Ÿä¸ºç»„ä»¶æ·»åŠ çŠ¶æ€å’Œä¿®æ”¹çŠ¶æ€çš„å€¼

> ä¸€ä¸ªå‰æï¼šåœ¨react hookå‡ºæ¥ä¹‹å‰ï¼Œå‡½æ•°å¼ç»„ä»¶æ˜¯æ²¡æœ‰è‡ªå·±çš„çŠ¶æ€çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»Ÿä¸€é€šè¿‡ç±»ç»„ä»¶æ¥è®²è§£
>
> æ­¥éª¤ï¼šåˆå§‹åŒ–çŠ¶æ€ -> è¯»å–çŠ¶æ€ -> ä¿®æ”¹çŠ¶æ€ -> å½±å“è§†å›¾

### 1. åˆå§‹åŒ–çŠ¶æ€

- é€šè¿‡classçš„å®ä¾‹å±æ€§stateæ¥åˆå§‹åŒ–

- stateçš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ç»“æ„ï¼Œè¡¨ç¤ºä¸€ä¸ªç»„ä»¶å¯ä»¥æœ‰å¤šä¸ªæ•°æ®çŠ¶æ€

  ```jsx
  class Counter extends React.Component {
    // åˆå§‹åŒ–çŠ¶æ€
    state = {
      count: 0
    }
    render() {
      return <button>è®¡æ•°å™¨</button>
    }
  }
  ```

### 2. è¯»å–çŠ¶æ€

- é€šè¿‡this.stateæ¥è·å–çŠ¶æ€

  ```jsx
  class Counter extends React.Component {
    // åˆå§‹åŒ–çŠ¶æ€
    state = {
      count: 0
    }
    render() {
      // è¯»å–çŠ¶æ€
      return <button>è®¡æ•°å™¨{this.state.count}</button>
    }
  }
  ```
  

### 3. ä¿®æ”¹çŠ¶æ€

- è¯­æ³•

  `this.setState({ è¦ä¿®æ”¹çš„éƒ¨åˆ†æ•°æ® })`

- setStateæ–¹æ³•ä½œç”¨

  1. ä¿®æ”¹stateä¸­çš„æ•°æ®çŠ¶æ€
  2. æ›´æ–°UI

- æ€æƒ³

  â€‹	æ•°æ®é©±åŠ¨è§†å›¾ï¼Œä¹Ÿå°±æ˜¯åªè¦ä¿®æ”¹æ•°æ®çŠ¶æ€ï¼Œé‚£ä¹ˆé¡µé¢å°±ä¼šè‡ªåŠ¨åˆ·æ–°ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œdom

- æ³¨æ„äº‹é¡¹

  â€‹	**ä¸è¦ç›´æ¥ä¿®æ”¹stateä¸­çš„å€¼ï¼Œå¿…é¡»é€šè¿‡setStateæ–¹æ³•è¿›è¡Œä¿®æ”¹**


```jsx
class Counter extends React.Component {
  // å®šä¹‰æ•°æ®
  state = {
    count: 0
  }
  // å®šä¹‰ä¿®æ”¹æ•°æ®çš„æ–¹æ³•
  setCount = () => {
    this.setState({
      count: this.state.count + 1
    })
  }
  // ä½¿ç”¨æ•°æ® å¹¶ç»‘å®šäº‹ä»¶
  render () {
    return <button onClick={this.setCount}>{this.state.count}</button>
  }
}
```

## thisé—®é¢˜è¯´æ˜

![](assets/this.png)

```jsx
// class fieldså†™æ³• æ¨èï¼ï¼
class Counter extends React.Component {
  // å®šä¹‰æ•°æ®
  state = {
    count: 0
  }
  // å®šä¹‰ä¿®æ”¹æ•°æ®çš„æ–¹æ³•
  setCount = () => {
    this.setState({
      count: this.state.count + 1
    })
  }
  // ä½¿ç”¨æ•°æ® å¹¶ç»‘å®šäº‹ä»¶
  render () {
    return <button onClick={this.setCount}>{this.state.count}</button>
  }
}

// ç®­å¤´å‡½æ•°å†™æ³•
class Counter extends React.Component {
  // å®šä¹‰æ•°æ®
  state = {
    count: 0
  }
  // å®šä¹‰ä¿®æ”¹æ•°æ®çš„æ–¹æ³•
  setCount () {
    this.setState({
      count: this.state.count + 1
    })
  }
  // ä½¿ç”¨æ•°æ® å¹¶ç»‘å®šäº‹ä»¶
  render () {
    return <button onClick={() => this.setCount()}>{this.state.count}</button>
  }
}

// constructorä¸­é€šè¿‡bindå¼ºè¡Œç»‘å®šthis
class Counter extends React.Component {
  // å®šä¹‰æ•°æ®
  state = {
    count: 0
  }
  constructor() {
    super()
    this.setCount = this.setCount.bind(this)
  }
  // å®šä¹‰ä¿®æ”¹æ•°æ®çš„æ–¹æ³•
  setCount () {
    this.setState({
      count: this.state.count + 1
    })
  }
  // ä½¿ç”¨æ•°æ® å¹¶ç»‘å®šäº‹ä»¶
  render () {
    return <button onClick={this.setCount}>{this.state.count}</button>
  }
}
```

è¿™é‡Œæˆ‘ä»¬ä½œä¸ºäº†è§£å†…å®¹ï¼Œéšç€jsæ ‡å‡†çš„å‘å±•ï¼Œä¸»æµçš„å†™æ³•å·²ç»å˜æˆäº†class fieldsï¼Œæ— éœ€è€ƒè™‘å¤ªå¤šthisé—®é¢˜

## Reactçš„çŠ¶æ€ä¸å¯å˜

`ç›®æ ‡ä»»åŠ¡:`  èƒ½å¤Ÿç†è§£ä¸å¯å˜çš„æ„ä¹‰å¹¶ä¸”çŸ¥é“åœ¨å®é™…å¼€å‘ä¸­å¦‚ä½•ä¿®æ”¹çŠ¶æ€

**æ¦‚å¿µ**ï¼šä¸è¦ç›´æ¥ä¿®æ”¹çŠ¶æ€çš„å€¼ï¼Œè€Œæ˜¯åŸºäºå½“å‰çŠ¶æ€åˆ›å»ºæ–°çš„çŠ¶æ€å€¼

**1. é”™è¯¯çš„ç›´æ¥ä¿®æ”¹**

```js
state = {
  count : 0,
  list: [1,2,3],
  person: {
     name:'jack',
     age:18
  }
}
// ç›´æ¥ä¿®æ”¹ç®€å•ç±»å‹Number
this.state.count++
++this.state.count
this.state.count += 1
this.state.count = 1

// ç›´æ¥ä¿®æ”¹æ•°ç»„
this.state.list.push(123)
this.state.list.spice(1,1)

// ç›´æ¥ä¿®æ”¹å¯¹è±¡
this.state.person.name = 'rose'
```

**2. åŸºäºå½“å‰çŠ¶æ€åˆ›å»ºæ–°å€¼**

```js
this.setState({
    count: this.state.count + 1
    list: [...this.state.list, 4],
    person: {
       ...this.state.person,
       // è¦†ç›–åŸæ¥çš„å±æ€§ å°±å¯ä»¥è¾¾åˆ°ä¿®æ”¹å¯¹è±¡ä¸­å±æ€§çš„ç›®çš„
       name: 'rose'
    }
})
```

## è¡¨å•å¤„ç†

`ç›®æ ‡ä»»åŠ¡:`  èƒ½å¤Ÿä½¿ç”¨å—æ§ç»„ä»¶çš„æ–¹å¼è·å–æ–‡æœ¬æ¡†çš„å€¼

ä½¿ç”¨Reactå¤„ç†è¡¨å•å…ƒç´ ï¼Œä¸€èˆ¬æœ‰ä¿©ç§æ–¹å¼ï¼š

1. å—æ§ç»„ä»¶ ï¼ˆæ¨èä½¿ç”¨ï¼‰

2. éå—æ§ç»„ä»¶ ï¼ˆäº†è§£ï¼‰

### 1. å—æ§è¡¨å•ç»„ä»¶

> ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶ï¼Ÿ  `inputæ¡†è‡ªå·±çš„çŠ¶æ€è¢«Reactç»„ä»¶çŠ¶æ€æ§åˆ¶`
>
> Reactç»„ä»¶çš„çŠ¶æ€çš„åœ°æ–¹æ˜¯åœ¨stateä¸­ï¼Œinputè¡¨å•å…ƒç´ ä¹Ÿæœ‰è‡ªå·±çš„çŠ¶æ€æ˜¯åœ¨valueä¸­ï¼ŒReactå°†stateä¸è¡¨å•å…ƒç´ çš„å€¼ï¼ˆvalueï¼‰ç»‘å®šåˆ°ä¸€èµ·ï¼Œç”±stateçš„å€¼æ¥æ§åˆ¶è¡¨å•å…ƒç´ çš„å€¼ï¼Œä»è€Œä¿è¯å•ä¸€æ•°æ®æºç‰¹æ€§

**å®ç°æ­¥éª¤**

ä»¥è·å–æ–‡æœ¬æ¡†çš„å€¼ä¸ºä¾‹ï¼Œå—æ§ç»„ä»¶çš„ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1. åœ¨ç»„ä»¶çš„stateä¸­å£°æ˜ä¸€ä¸ªç»„ä»¶çš„çŠ¶æ€æ•°æ®
2. å°†çŠ¶æ€æ•°æ®è®¾ç½®ä¸ºinputæ ‡ç­¾å…ƒç´ çš„valueå±æ€§çš„å€¼
3. ä¸ºinputæ·»åŠ changeäº‹ä»¶ï¼Œåœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œé€šè¿‡äº‹ä»¶å¯¹è±¡eè·å–åˆ°å½“å‰æ–‡æœ¬æ¡†çš„å€¼ï¼ˆ`å³ç”¨æˆ·å½“å‰è¾“å…¥çš„å€¼`ï¼‰

4. è°ƒç”¨setStateæ–¹æ³•ï¼Œå°†æ–‡æœ¬æ¡†çš„å€¼ä½œä¸ºstateçŠ¶æ€çš„æœ€æ–°å€¼

**ä»£ç è½åœ°**

```jsx
import React from 'react'

class InputComponent extends React.Component {
  // å£°æ˜ç»„ä»¶çŠ¶æ€
  state = {
    message: 'this is message',
  }
  // å£°æ˜äº‹ä»¶å›è°ƒå‡½æ•°
  changeHandler = (e) => {
    this.setState({ message: e.target.value })
  }
  render () {
    return (
      <div>
        {/* ç»‘å®švalue ç»‘å®šäº‹ä»¶*/}
        <input value={this.state.message} onChange={this.changeHandler} />
      </div>
    )
  }
}


function App () {
  return (
    <div className="App">
      <InputComponent />
    </div>
  )
}
export default App
```

### 2. éå—æ§è¡¨å•ç»„ä»¶

> ä»€ä¹ˆæ˜¯éå—æ§ç»„ä»¶ï¼Ÿ
>
> éå—æ§ç»„ä»¶å°±æ˜¯é€šè¿‡æ‰‹åŠ¨æ“ä½œdomçš„æ–¹å¼è·å–æ–‡æœ¬æ¡†çš„å€¼ï¼Œæ–‡æœ¬æ¡†çš„çŠ¶æ€ä¸å—reactç»„ä»¶çš„stateä¸­çš„çŠ¶æ€æ§åˆ¶ï¼Œç›´æ¥é€šè¿‡åŸç”Ÿdomè·å–è¾“å…¥æ¡†çš„å€¼

**å®ç°æ­¥éª¤**

1. å¯¼å…¥`createRef` å‡½æ•°
2. è°ƒç”¨createRefå‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªrefå¯¹è±¡ï¼Œå­˜å‚¨åˆ°åä¸º`msgRef`çš„å®ä¾‹å±æ€§ä¸­
3. ä¸ºinputæ·»åŠ refå±æ€§ï¼Œå€¼ä¸º`msgRef`
4. åœ¨æŒ‰é’®çš„äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œé€šè¿‡`msgRef.current`å³å¯æ‹¿åˆ°inputå¯¹åº”çš„domå…ƒç´ ï¼Œè€Œå…¶ä¸­`msgRef.current.value`æ‹¿åˆ°çš„å°±æ˜¯æ–‡æœ¬æ¡†çš„å€¼

**ä»£ç è½åœ°**

```jsx
import React, { createRef } from 'react'

class InputComponent extends React.Component {
  // ä½¿ç”¨createRefäº§ç”Ÿä¸€ä¸ªå­˜æ”¾domçš„å¯¹è±¡å®¹å™¨
  msgRef = createRef()

  changeHandler = () => {
    console.log(this.msgRef.current.value)
  }

  render() {
    return (
      <div>
        {/* refç»‘å®š è·å–çœŸå®dom */}
        <input ref={this.msgRef} />
        <button onClick={this.changeHandler}>click</button>
      </div>
    )
  }
}

function App () {
  return (
    <div className="App">
      <InputComponent />
    </div>
  )
}
export default App
```

## é˜¶æ®µå°ç»ƒä¹ 

![](assets/jsx-demo.png)

ç»ƒä¹ è¯´æ˜

 1. æ‹‰å–é¡¹ç›®æ¨¡æ¿åˆ°æœ¬åœ°ï¼Œå®‰è£…ä¾èµ–ï¼Œrunèµ·æ¥é¡¹ç›®

    https://gitee.com/react-course-series/react-component-demo

2. å®Œæˆtabç‚¹å‡»åˆ‡æ¢æ¿€æ´»çŠ¶æ€äº¤äº’

3. å®Œæˆå‘è¡¨è¯„è®ºåŠŸèƒ½

   æ³¨æ„ï¼šç”Ÿæˆç‹¬ç«‹æ— äºŒçš„id å¯ä»¥ä½¿ç”¨  uuid åŒ…  `yarn add uuid`

   ```js
   import {v4 as uuid} from 'uuid'
   uuid() // å¾—åˆ°ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„id
   ```

4. å®Œæˆåˆ é™¤è¯„è®ºåŠŸèƒ½

# Reactç»„ä»¶é€šä¿¡

## ç»„ä»¶é€šä¿¡çš„æ„ä¹‰

`ç›®æ ‡ä»»åŠ¡:`   äº†è§£ä¸ºä»€ä¹ˆéœ€è¦ç»„ä»¶é€šä¿¡

ç»„ä»¶æ˜¯ç‹¬ç«‹ä¸”å°é—­çš„å•å…ƒï¼Œé»˜è®¤æƒ…å†µä¸‹ç»„ä»¶**åªèƒ½ä½¿ç”¨è‡ªå·±çš„æ•°æ®ï¼ˆstateï¼‰**

ç»„ä»¶åŒ–å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œå®Œæ•´çš„åŠŸèƒ½ä¼šæ‹†åˆ†å¤šä¸ªç»„ä»¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸å¯é¿å…çš„éœ€è¦äº’ç›¸ä¼ é€’ä¸€äº›æ•°æ®

ä¸ºäº†èƒ½è®©å„ç»„ä»¶ä¹‹é—´å¯ä»¥è¿›è¡Œäº’ç›¸æ²Ÿé€šï¼Œæ•°æ®ä¼ é€’ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ç»„ä»¶é€šä¿¡

1. çˆ¶å­å…³ç³» -  **æœ€é‡è¦çš„**
2. å…„å¼Ÿå…³ç³» -  è‡ªå®šä¹‰äº‹ä»¶æ¨¡å¼äº§ç”ŸæŠ€æœ¯æ–¹æ³• eventBus  /  é€šè¿‡å…±åŒçš„çˆ¶ç»„ä»¶é€šä¿¡
3. å…¶å®ƒå…³ç³» -  **mobx / redux / åŸºäºhookçš„æ–¹æ¡ˆ**

## çˆ¶ä¼ å­å®ç°

`ç›®æ ‡ä»»åŠ¡:`   å®ç°çˆ¶å­é€šä¿¡ä¸­çš„çˆ¶ä¼ å­ï¼ŒæŠŠçˆ¶ç»„ä»¶ä¸­çš„æ•°æ®ä¼ ç»™å­ç»„ä»¶

**å®ç°æ­¥éª¤**

1. çˆ¶ç»„ä»¶æä¾›è¦ä¼ é€’çš„æ•°æ®  -  `state`

2. ç»™å­ç»„ä»¶æ ‡ç­¾`æ·»åŠ å±æ€§`å€¼ä¸º stateä¸­çš„æ•°æ®  

3. å­ç»„ä»¶ä¸­é€šè¿‡ `props` æ¥æ”¶çˆ¶ç»„ä»¶ä¸­ä¼ è¿‡æ¥çš„æ•°æ®

   1. ç±»ç»„ä»¶ä½¿ç”¨this.propsè·å–propså¯¹è±¡
   2. å‡½æ•°å¼ç»„ä»¶ç›´æ¥é€šè¿‡å‚æ•°è·å–propså¯¹è±¡

   

![](assets/props-1.png)



**ä»£ç å®ç°**

```jsx
import React from 'react'

// å‡½æ•°å¼å­ç»„ä»¶
function FSon(props) {
  console.log(props)
  return (
    <div>
      å­ç»„ä»¶1
      {props.msg}
    </div>
  )
}

// ç±»å­ç»„ä»¶
class CSon extends React.Component {
  render() {
    return (
      <div>
        å­ç»„ä»¶2
        {this.props.msg}
      </div>
    )
  }
}
// çˆ¶ç»„ä»¶
class App extends React.Component {
  state = {
    message: 'this is message'
  }
  render() {
    return (
      <div>
        <div>çˆ¶ç»„ä»¶</div>
        <FSon msg={this.state.message} />
        <CSon msg={this.state.message} />
      </div>
    )
  }
}

export default App
```

## propsè¯´æ˜

`ç›®æ ‡ä»»åŠ¡:`   çŸ¥é“propsä¼ é€’æ—¶çš„ä¸€äº›æ³¨æ„äº‹é¡¹

**1.  propsæ˜¯åªè¯»å¯¹è±¡ï¼ˆreadonlyï¼‰**

æ ¹æ®å•é¡¹æ•°æ®æµçš„è¦æ±‚ï¼Œå­ç»„ä»¶åªèƒ½è¯»å–propsä¸­çš„æ•°æ®ï¼Œä¸èƒ½è¿›è¡Œä¿®æ”¹

**2. propså¯ä»¥ä¼ é€’ä»»æ„æ•°æ®**

æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€æ•°ç»„ã€å¯¹è±¡ã€`å‡½æ•°ã€JSX`

```jsx
class App extends React.Component {
  state = {
    message: 'this is message'
  }
  render() {
    return (
      <div>
        <div>çˆ¶ç»„ä»¶</div>
        <FSon 
          msg={this.state.message} 
          age={20} 
          isMan={true} 
          cb={() => { console.log(1) }} 
          child={<span>this is child</span>}
        />
        <CSon msg={this.state.message} />
      </div>
    )
  }
}
```

![](assets/props-2.png)



## å­ä¼ çˆ¶å®ç°

`ç›®æ ‡ä»»åŠ¡:`   å®ç°çˆ¶å­é€šä¿¡ä¸­çš„å­ä¼ çˆ¶

**å£è¯€ï¼š** çˆ¶ç»„ä»¶ç»™å­ç»„ä»¶ä¼ é€’å›è°ƒå‡½æ•°ï¼Œå­ç»„ä»¶è°ƒç”¨

**å®ç°æ­¥éª¤**

1. çˆ¶ç»„ä»¶æä¾›ä¸€ä¸ªå›è°ƒå‡½æ•° - ç”¨äºæ¥æ”¶æ•°æ®
2. å°†å‡½æ•°ä½œä¸ºå±æ€§çš„å€¼ï¼Œä¼ ç»™å­ç»„ä»¶
3. å­ç»„ä»¶é€šè¿‡propsè°ƒç”¨ å›è°ƒå‡½æ•°
4. å°†å­ç»„ä»¶ä¸­çš„æ•°æ®ä½œä¸ºå‚æ•°ä¼ é€’ç»™å›è°ƒå‡½æ•°

![](assets/props-4.png)

**ä»£ç å®ç°**

```jsx
import React from 'react'

// å­ç»„ä»¶
function Son(props) {
  function handleClick() {
    // è°ƒç”¨çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å›è°ƒå‡½æ•° å¹¶æ³¨å…¥å‚æ•°
    props.changeMsg('this is newMessage')
  }
  return (
    <div>
      {props.msg}
      <button onClick={handleClick}>change</button>
    </div>
  )
}


class App extends React.Component {
  state = {
    message: 'this is message'
  }
  // æä¾›å›è°ƒå‡½æ•°
  changeMessage = (newMsg) => {
    console.log('å­ç»„ä»¶ä¼ è¿‡æ¥çš„æ•°æ®:',newMsg)
    this.setState({
      message: newMsg
    })
  }
  render() {
    return (
      <div>
        <div>çˆ¶ç»„ä»¶</div>
        <Son
          msg={this.state.message}
          // ä¼ é€’ç»™å­ç»„ä»¶
          changeMsg={this.changeMessage}
        />
      </div>
    )
  }
}

export default App
```

## å…„å¼Ÿç»„ä»¶é€šä¿¡

`ç›®æ ‡ä»»åŠ¡:`   å®ç°å…„å¼Ÿç»„ä»¶ä¹‹é—´çš„é€šä¿¡

**æ ¸å¿ƒæ€è·¯ï¼š** é€šè¿‡çŠ¶æ€æå‡æœºåˆ¶ï¼Œåˆ©ç”¨å…±åŒçš„çˆ¶ç»„ä»¶å®ç°å…„å¼Ÿé€šä¿¡

![](assets/props-5.png)

**å®ç°æ­¥éª¤**

1. å°†å…±äº«çŠ¶æ€æå‡åˆ°æœ€è¿‘çš„å…¬å…±çˆ¶ç»„ä»¶ä¸­ï¼Œç”±å…¬å…±çˆ¶ç»„ä»¶ç®¡ç†è¿™ä¸ªçŠ¶æ€

   - æä¾›å…±äº«çŠ¶æ€ 

   - æä¾›æ“ä½œå…±äº«çŠ¶æ€çš„æ–¹æ³•

2. è¦æ¥æ”¶æ•°æ®çŠ¶æ€çš„å­ç»„ä»¶é€šè¿‡ props æ¥æ”¶æ•°æ®
3. è¦ä¼ é€’æ•°æ®çŠ¶æ€çš„å­ç»„ä»¶é€šè¿‡propsæ¥æ”¶æ–¹æ³•ï¼Œè°ƒç”¨æ–¹æ³•ä¼ é€’æ•°æ®



**ä»£ç å®ç°**

```jsx
import React from 'react'

// å­ç»„ä»¶A
function SonA(props) {
  return (
    <div>
      SonA
      {props.msg}
    </div>
  )
}
// å­ç»„ä»¶B
function SonB(props) {
  return (
    <div>
      SonB
      <button onClick={() => props.changeMsg('new message')}>changeMsg</button>
    </div>
  )
}

// çˆ¶ç»„ä»¶
class App extends React.Component {
  // çˆ¶ç»„ä»¶æä¾›çŠ¶æ€æ•°æ®
  state = {
    message: 'this is message'
  }
  // çˆ¶ç»„ä»¶æä¾›ä¿®æ”¹æ•°æ®çš„æ–¹æ³•
  changeMsg = (newMsg) => {
    this.setState({
      message: newMsg
    })
  }

  render() {
    return (
      <>
        {/* æ¥æ”¶æ•°æ®çš„ç»„ä»¶ */}
        <SonA msg={this.state.message} />
        {/* ä¿®æ”¹æ•°æ®çš„ç»„ä»¶ */}
        <SonB changeMsg={this.changeMsg} />
      </>
    )
  }
}

export default App
```

## è·¨ç»„ä»¶é€šä¿¡Context

`ç›®æ ‡ä»»åŠ¡:`   äº†è§£Contextæœºåˆ¶è§£å†³çš„é—®é¢˜å’Œä½¿ç”¨æ­¥éª¤

**é—®é¢˜åœºæ™¯**

<img src="assets/context.png"/>

> ä¸Šå›¾æ˜¯ä¸€ä¸ªreactå½¢æˆçš„åµŒå¥—ç»„ä»¶æ ‘ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä»Appç»„ä»¶å‘ä»»æ„ä¸€ä¸ªä¸‹å±‚ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿç›®å‰æˆ‘ä»¬èƒ½é‡‡å–çš„æ–¹å¼å°±æ˜¯ä¸€å±‚ä¸€å±‚çš„propså¾€ä¸‹ä¼ ï¼Œæ˜¾ç„¶å¾ˆç¹ç
>
> é‚£ä¹ˆï¼ŒContext æä¾›äº†ä¸€ä¸ª**æ— éœ€ä¸ºæ¯å±‚ç»„ä»¶æ‰‹åŠ¨æ·»åŠ  propsï¼Œå°±èƒ½åœ¨ç»„ä»¶æ ‘é—´è¿›è¡Œæ•°æ®ä¼ é€’çš„æ–¹æ³•**



**å®ç°æ­¥éª¤**

1. åˆ›å»ºContextå¯¹è±¡ å¯¼å‡º Provider å’Œ Consumerå¯¹è±¡

   ```js
   const { Provider, Consumer } = createContext()
   ```

2. ä½¿ç”¨ProvideråŒ…è£¹æ ¹ç»„ä»¶æä¾›æ•°æ® 

   ```jsx
   <Provider value={this.state.message}>
       {/* æ ¹ç»„ä»¶ */}
   </Provider>
   ```

3. éœ€è¦ç”¨åˆ°æ•°æ®çš„ç»„ä»¶ä½¿ç”¨ConsumeråŒ…è£¹è·å–æ•°æ®

   ```jsx
   <Consumer >
       {value => /* åŸºäº context å€¼è¿›è¡Œæ¸²æŸ“*/}
   </Consumer>
   ```

   

**ä»£ç å®ç°**

```jsx
import React, { createContext }  from 'react'

// 1. åˆ›å»ºContextå¯¹è±¡ 
const { Provider, Consumer } = createContext()


// 3. æ¶ˆè´¹æ•°æ®
function ComC() {
  return (
    <Consumer >
      {value => <div>{value}</div>}
    </Consumer>
  )
}

function ComA() {
  return (
    <ComC/>
  )
}

// 2. æä¾›æ•°æ®
class App extends React.Component {
  state = {
    message: 'this is message'
  }
  render() {
    return (
      <Provider value={this.state.message}>
        <div className="app">
          <ComA />
        </div>
      </Provider>
    )
  }
}

export default App
```





## é˜¶æ®µå°ç»ƒä¹ 

> è¦æ±‚ï¼šAppä¸ºçˆ¶ç»„ä»¶ç”¨æ¥æä¾›åˆ—è¡¨æ•°æ® ï¼ŒListItemä¸ºå­ç»„ä»¶ç”¨æ¥æ¸²æŸ“åˆ—è¡¨æ•°æ®

![](assets/props-3.png)

```js
// åˆ—è¡¨æ•°æ®
[
  { id: 1, name: 'è¶…çº§å¥½åƒçš„æ£’æ£’ç³–', price: 18.8, info: 'å¼€ä¸šå¤§é…¬å®¾ï¼Œå…¨åœº8æŠ˜' },
  { id: 2, name: 'è¶…çº§å¥½åƒçš„å¤§é¸¡è…¿', price: 34.2, info: 'å¼€ä¸šå¤§é…¬å®¾ï¼Œå…¨åœº8æŠ˜' },
  { id: 3, name: 'è¶…çº§æ— æ•Œçš„å†°æ¿€å‡Œ', price: 14.2, info: 'å¼€ä¸šå¤§é…¬å®¾ï¼Œå…¨åœº8æŠ˜' }
]
```

å®Œæ•´ä»£ç 

```jsx
import React from 'react'

// å­ç»„ä»¶
function ListItem(props) {
  const { name, price, info, id, delHandler } = props
  return (
    <div>
      <h3>{name}</h3>
      <p>{price}</p>
      <p>{info}</p>
      <button onClick={() => delHandler(id)}>åˆ é™¤</button>
    </div>
  )
}

// çˆ¶ç»„ä»¶
class App extends React.Component {
  state = {
    list: [
      { id: 1, name: 'è¶…çº§å¥½åƒçš„æ£’æ£’ç³–', price: 18.8, info: 'å¼€ä¸šå¤§é…¬å®¾ï¼Œå…¨åœº8æŠ˜' },
      { id: 2, name: 'è¶…çº§å¥½åƒçš„å¤§é¸¡è…¿', price: 34.2, info: 'å¼€ä¸šå¤§é…¬å®¾ï¼Œå…¨åœº8æŠ˜' },
      { id: 3, name: 'è¶…çº§æ— æ•Œçš„å†°æ¿€å‡Œ', price: 14.2, info: 'å¼€ä¸šå¤§é…¬å®¾ï¼Œå…¨åœº8æŠ˜' }
    ]
  }

  delHandler = (id) => {
    this.setState({
      list: this.state.list.filter(item => item.id !== id)
    })
  }

  render() {
    return (
      <>
        {
          this.state.list.map(item =>
            <ListItem
              key={item.id}
              {...item}
              delHandler={this.delHandler} 
            />
          )
        }
      </>
    )
  }
}

export default App
```



# Reactç»„ä»¶è¿›é˜¶

## childrenå±æ€§

`ç›®æ ‡ä»»åŠ¡:`  æŒæ¡propsä¸­childrenå±æ€§çš„ç”¨æ³•

**childrenå±æ€§æ˜¯ä»€ä¹ˆ**

è¡¨ç¤ºè¯¥ç»„ä»¶çš„å­èŠ‚ç‚¹ï¼Œåªè¦ç»„ä»¶å†…éƒ¨æœ‰å­èŠ‚ç‚¹ï¼Œpropsä¸­å°±æœ‰è¯¥å±æ€§

**childrenå¯ä»¥æ˜¯ä»€ä¹ˆ**

1. æ™®é€šæ–‡æœ¬
2. æ™®é€šæ ‡ç­¾å…ƒç´ 
3. å‡½æ•°
4. JSX

**ç›®çš„ï¼šé«˜é˜¶ç»„ä»¶  render Props**

## propsæ ¡éªŒ-åœºæ™¯å’Œä½¿ç”¨

`ç›®æ ‡ä»»åŠ¡:`  æŒæ¡ç»„ä»¶propsçš„æ ¡éªŒå†™æ³•ï¼Œå¢åŠ ç»„ä»¶çš„å¥å£®æ€§

> å¯¹äºç»„ä»¶æ¥è¯´ï¼Œpropsæ˜¯ç”±å¤–éƒ¨ä¼ å…¥çš„ï¼Œæˆ‘ä»¬å…¶å®æ— æ³•ä¿è¯ç»„ä»¶ä½¿ç”¨è€…ä¼ å…¥äº†ä»€ä¹ˆæ ¼å¼çš„æ•°æ®ï¼Œå¦‚æœä¼ å…¥çš„æ•°æ®æ ¼å¼ä¸å¯¹ï¼Œå°±æœ‰å¯èƒ½ä¼šå¯¼è‡´ç»„ä»¶å†…éƒ¨é”™è¯¯ï¼Œæœ‰ä¸€ä¸ªç‚¹å¾ˆå…³é”® - **ç»„ä»¶çš„ä½¿ç”¨è€…å¯èƒ½æŠ¥é”™äº†ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ**ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­

![](assets/props-rule.png)

é¢å¯¹è¿™æ ·çš„é—®é¢˜ï¼Œå¦‚ä½•è§£å†³ï¼Ÿ **propsæ ¡éªŒ**

**å®ç°æ­¥éª¤**

1. å®‰è£…å±æ€§æ ¡éªŒåŒ…ï¼š`yarn add prop-types`
2. å¯¼å…¥`prop-types` åŒ…
3. ä½¿ç”¨ `ç»„ä»¶å.propTypes = {}` ç»™ç»„ä»¶æ·»åŠ æ ¡éªŒè§„åˆ™

**æ ¸å¿ƒä»£ç **

```jsx
import PropTypes from 'prop-types'

const List = props => {
  const arr = props.colors
  const lis = arr.map((item, index) => <li key={index}>{item.name}</li>)
  return <ul>{lis}</ul>
}

List.propTypes = {
  colors: PropTypes.array
}
```

## propsæ ¡éªŒ-è§„åˆ™è¯´æ˜

`ç›®æ ‡ä»»åŠ¡:`  æŒæ¡propså¸¸è§çš„è§„åˆ™

**å››ç§å¸¸è§ç»“æ„**

1. å¸¸è§ç±»å‹ï¼šarrayã€boolã€funcã€numberã€objectã€string
2. Reactå…ƒç´ ç±»å‹ï¼šelement
3. å¿…å¡«é¡¹ï¼šisRequired
4. ç‰¹å®šçš„ç»“æ„å¯¹è±¡ï¼šshape({})

**æ ¸å¿ƒä»£ç **

```js
// å¸¸è§ç±»å‹
optionalFunc: PropTypes.func,
// å¿…å¡« åªéœ€è¦åœ¨ç±»å‹åé¢ä¸²è”ä¸€ä¸ªisRequired
requiredFunc: PropTypes.func.isRequired,
// ç‰¹å®šç»“æ„çš„å¯¹è±¡
optionalObjectWithShape: PropTypes.shape({
	color: PropTypes.string,
	fontSize: PropTypes.number
})
```

å®˜ç½‘æ–‡æ¡£æ›´å¤šé˜…è¯»ï¼šhttps://reactjs.org/docs/typechecking-with-proptypes.html



## propsæ ¡éªŒ-é»˜è®¤å€¼

`ç›®æ ‡ä»»åŠ¡:`  æŒæ¡å¦‚ä½•ç»™ç»„ä»¶çš„propsæä¾›é»˜è®¤å€¼

> é€šè¿‡ `defaultProps` å¯ä»¥ç»™ç»„ä»¶çš„propsè®¾ç½®é»˜è®¤å€¼ï¼Œåœ¨æœªä¼ å…¥propsçš„æ—¶å€™ç”Ÿæ•ˆ

### 1. å‡½æ•°ç»„ä»¶

ç›´æ¥ä½¿ç”¨å‡½æ•°å‚æ•°é»˜è®¤å€¼

```jsx
function List({pageSize = 10}) {
  return (
    <div>
      æ­¤å¤„å±•ç¤ºpropsçš„é»˜è®¤å€¼ï¼š{ pageSize }
    </div>
  )
}

// ä¸ä¼ å…¥pageSizeå±æ€§
<List />
```

### 2. ç±»ç»„ä»¶

ä½¿ç”¨ç±»é™æ€å±æ€§å£°æ˜é»˜è®¤å€¼ï¼Œ`static defaultProps = {}`

```jsx
class List extends Component {
  static defaultProps = {
    pageSize: 10
  }
    
  render() {
    return (
      <div>
        æ­¤å¤„å±•ç¤ºpropsçš„é»˜è®¤å€¼ï¼š{this.props.pageSize}
      </div>
    )
  }
}
<List />
```

## ç”Ÿå‘½å‘¨æœŸ - æ¦‚è¿°

`ç›®æ ‡ä»»åŠ¡:`  èƒ½å¤Ÿè¯´å‡ºç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¸€å…±å‡ ä¸ªé˜¶æ®µ

> ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æŒ‡ç»„ä»¶ä»è¢«åˆ›å»ºåˆ°æŒ‚è½½åˆ°é¡µé¢ä¸­è¿è¡Œèµ·æ¥ï¼Œå†åˆ°ç»„ä»¶ä¸ç”¨æ—¶å¸è½½çš„è¿‡ç¨‹ï¼Œæ³¨æ„ï¼Œåªæœ‰ç±»ç»„ä»¶æ‰æœ‰ç”Ÿå‘½å‘¨æœŸï¼ˆç±»ç»„ä»¶ å®ä¾‹åŒ–  å‡½æ•°ç»„ä»¶ ä¸éœ€è¦å®ä¾‹åŒ–ï¼‰

![](assets/life.png)

<http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/>



## ç”Ÿå‘½å‘¨æœŸ - æŒ‚è½½é˜¶æ®µ

`ç›®æ ‡ä»»åŠ¡:`  èƒ½å¤Ÿè¯´å‡ºåœ¨ç»„ä»¶æŒ‚è½½é˜¶æ®µæ‰§è¡Œçš„é’©å­å‡½æ•°å’Œæ‰§è¡Œæ—¶æœº

![](assets/life1.png)

| é’©å­ å‡½æ•°         | è§¦å‘æ—¶æœº                                            | ä½œç”¨                                                         |
| ----------------- | --------------------------------------------------- | ------------------------------------------------------------ |
| constructor       | åˆ›å»ºç»„ä»¶æ—¶ï¼Œæœ€å…ˆæ‰§è¡Œï¼Œåˆå§‹åŒ–çš„æ—¶å€™åªæ‰§è¡Œä¸€æ¬¡        | 1. åˆå§‹åŒ–state  2. åˆ›å»º Ref 3. ä½¿ç”¨ bind è§£å†³ this æŒ‡å‘é—®é¢˜ç­‰ |
| render            | æ¯æ¬¡ç»„ä»¶æ¸²æŸ“éƒ½ä¼šè§¦å‘                                | æ¸²æŸ“UIï¼ˆ**æ³¨æ„ï¼š ä¸èƒ½åœ¨é‡Œé¢è°ƒç”¨setState()** ï¼‰               |
| componentDidMount | ç»„ä»¶æŒ‚è½½ï¼ˆå®ŒæˆDOMæ¸²æŸ“ï¼‰åæ‰§è¡Œï¼Œåˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ | 1. å‘é€ç½‘ç»œè¯·æ±‚   2.DOMæ“ä½œ                                  |

## ç”Ÿå‘½å‘¨æœŸ - æ›´æ–°é˜¶æ®µ

`ç›®æ ‡ä»»åŠ¡:`  èƒ½å¤Ÿè¯´å‡ºç»„ä»¶çš„æ›´æ–°é˜¶æ®µçš„é’©å­å‡½æ•°ä»¥åŠæ‰§è¡Œæ—¶æœº

![](assets/life2.png)

| é’©å­å‡½æ•°           | è§¦å‘æ—¶æœº                  | ä½œç”¨                                                         |
| ------------------ | ------------------------- | ------------------------------------------------------------ |
| render             | æ¯æ¬¡ç»„ä»¶æ¸²æŸ“éƒ½ä¼šè§¦å‘      | æ¸²æŸ“UIï¼ˆä¸ æŒ‚è½½é˜¶æ®µ æ˜¯åŒä¸€ä¸ªrenderï¼‰                         |
| componentDidUpdate | ç»„ä»¶æ›´æ–°åï¼ˆDOMæ¸²æŸ“å®Œæ¯•ï¼‰ | DOMæ“ä½œï¼Œå¯ä»¥è·å–åˆ°æ›´æ–°åçš„DOMå†…å®¹ï¼Œ**ä¸è¦ç›´æ¥è°ƒç”¨setState** |

## ç”Ÿå‘½å‘¨æœŸ - å¸è½½é˜¶æ®µ

`ç›®æ ‡ä»»åŠ¡:`  èƒ½å¤Ÿè¯´å‡ºç»„ä»¶çš„é”€æ¯é˜¶æ®µçš„é’©å­å‡½æ•°ä»¥åŠæ‰§è¡Œæ—¶æœº

| é’©å­å‡½æ•°             | è§¦å‘æ—¶æœº                 | ä½œç”¨                               |
| -------------------- | ------------------------ | ---------------------------------- |
| componentWillUnmount | ç»„ä»¶å¸è½½ï¼ˆä»é¡µé¢ä¸­æ¶ˆå¤±ï¼‰ | æ‰§è¡Œæ¸…ç†å·¥ä½œï¼ˆæ¯”å¦‚ï¼šæ¸…ç†å®šæ—¶å™¨ç­‰ï¼‰ |

## é˜¶æ®µå°ç»ƒä¹  - todoMVC

æ¡ˆä¾‹ä»“åº“åœ°å€ï¼šhttps://gitee.com/react-course-series/react-todo-mvc

**é¡¹ç›®æ¼”ç¤ºæ­¥éª¤ï¼š**

1. å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°

   ```bash
   git clone  https://gitee.com/react-course-series/react-todo-mvc.git
   ```

2. å®‰è£…å¿…è¦ä¾èµ–

   ```bash
   yarn
   ```

3. å¼€å¯mockæ¥å£æœåŠ¡ï¼Œ**ä¿æŒçª—å£ä¸å…³é—­**  ï¼ï¼ï¼ï¼ï¼

   ```bash
   # å¯åŠ¨mockæœåŠ¡
   yarn mock-serve
   ```

4. **å¦èµ·ä¸€ä¸ªbashçª—å£**å¼€å¯å‰ç«¯æœåŠ¡

   ```bash
   yarn start
   ```

5. æµè§ˆå™¨è¾“å…¥ localhost:3000æ¼”ç¤ºæ•ˆæœ

**é¡¹ç›®å¼€å‘æ­¥éª¤ï¼š**

1. åˆ‡æ¢åˆ°todo-teståˆ†æ”¯

   ```bash
   git checkout todo-test
   ```

2. æ‰“å¼€ app.js

   å·²æœ‰åŸºç¡€æ ·æ¿ä»£ç ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šç¼–å†™ä¸šåŠ¡é€»è¾‘å³å¯

3. æ¥å£æ–‡æ¡£

   | æ¥å£ä½œç”¨ | æ¥å£åœ°å€                              | æ¥å£æ–¹æ³• | æ¥å£å‚æ•°               |
   | -------- | ------------------------------------- | -------- | ---------------------- |
   | è·å–åˆ—è¡¨ | http://localhost:3001/data            | GET      | æ—                      |
   | åˆ é™¤     | http://localhost:3001/data/:id        | DELETE   | id                     |
   | æœç´¢     | http://localhost:3001/data/?q=keyword | GET      | nameï¼ˆä»¥nameå­—æ®µæœç´¢ï¼‰ |

**å®ç°åŠŸèƒ½**

| åŠŸèƒ½         | æ ¸å¿ƒæ€è·¯                             |
| ------------ | ------------------------------------ |
| è¡¨æ ¼æ•°æ®æ¸²æŸ“ | elementPlus el-tableç»„ä»¶ä½¿ç”¨         |
| åˆ é™¤åŠŸèƒ½     | è·å–å½“å‰id  è°ƒç”¨æ¥å£                 |
| æœç´¢åŠŸèƒ½     | ç”¨çš„ä¾æ—§æ˜¯åˆ—è¡¨æ¥å£ï¼Œå¤šä¼ ä¸€ä¸ªnameå‚æ•° |
| æ¸…é™¤æœç´¢åŠŸèƒ½ | æ¸…ç©ºæœç´¢å‚æ•°  é‡æ–°è·å–åˆ—è¡¨           |

# HooksåŸºç¡€

## Hooksæ¦‚å¿µç†è§£

`æœ¬èŠ‚ä»»åŠ¡:` èƒ½å¤Ÿç†è§£hooksçš„æ¦‚å¿µåŠè§£å†³çš„é—®é¢˜

### 1. ä»€ä¹ˆæ˜¯hooks

> Hooksçš„æœ¬è´¨ï¼š**ä¸€å¥—èƒ½å¤Ÿä½¿å‡½æ•°ç»„ä»¶æ›´å¼ºå¤§ï¼Œæ›´çµæ´»çš„â€œé’©å­â€**

Reactä½“ç³»é‡Œç»„ä»¶åˆ†ä¸º ç±»ç»„ä»¶ å’Œ å‡½æ•°ç»„ä»¶

ç»è¿‡å¤šå¹´çš„å®æˆ˜ï¼Œå‡½æ•°ç»„ä»¶æ˜¯ä¸€ä¸ªæ›´åŠ åŒ¹é…Reactçš„è®¾è®¡ç†å¿µ `UI = f(data)`ï¼Œä¹Ÿæ›´æœ‰åˆ©äºé€»è¾‘æ‹†åˆ†ä¸é‡ç”¨çš„ç»„ä»¶è¡¨è¾¾å½¢å¼ï¼Œè€Œå…ˆå‰çš„å‡½æ•°ç»„ä»¶æ˜¯ä¸å¯ä»¥æœ‰è‡ªå·±çš„çŠ¶æ€çš„ï¼Œä¸ºäº†èƒ½è®©å‡½æ•°ç»„ä»¶å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€ï¼Œæ‰€ä»¥ä»react v16.8å¼€å§‹ï¼ŒHooksåº”è¿è€Œç”Ÿ

**æ³¨æ„ç‚¹ï¼š**

1. æœ‰äº†hooksä¹‹åï¼Œä¸ºäº†å…¼å®¹è€ç‰ˆæœ¬ï¼Œclassç±»ç»„ä»¶å¹¶æ²¡æœ‰è¢«ç§»é™¤ï¼Œä¿©è€…éƒ½å¯ä»¥ä½¿ç”¨
2. æœ‰äº†hooksä¹‹åï¼Œä¸èƒ½åœ¨æŠŠå‡½æ•°æˆä¸ºæ— çŠ¶æ€ç»„ä»¶äº†ï¼Œå› ä¸ºhooksä¸ºå‡½æ•°ç»„ä»¶æä¾›äº†çŠ¶æ€
3. hooksåªèƒ½åœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨

### 2. Hooksè§£å†³äº†ä»€ä¹ˆé—®é¢˜

Hooksçš„å‡ºç°è§£å†³äº†ä¿©ä¸ªé—®é¢˜    1. ç»„ä»¶çš„çŠ¶æ€é€»è¾‘å¤ç”¨  2.classç»„ä»¶è‡ªèº«çš„é—®é¢˜

1. ç»„ä»¶çš„é€»è¾‘å¤ç”¨

   åœ¨hookså‡ºç°ä¹‹å‰ï¼Œreactå…ˆåå°è¯•äº† mixinsæ··å…¥ï¼ŒHOCé«˜é˜¶ç»„ä»¶ï¼Œrender-propsç­‰æ¨¡å¼

   ä½†æ˜¯éƒ½æœ‰å„è‡ªçš„é—®é¢˜ï¼Œæ¯”å¦‚mixinçš„æ•°æ®æ¥æºä¸æ¸…æ™°ï¼Œé«˜é˜¶ç»„ä»¶çš„åµŒå¥—é—®é¢˜ç­‰ç­‰

2. classç»„ä»¶è‡ªèº«çš„é—®é¢˜

   classç»„ä»¶å°±åƒä¸€ä¸ªåšé‡çš„â€˜æˆ˜èˆ°â€™ ä¸€æ ·ï¼Œå¤§è€Œå…¨ï¼Œæä¾›äº†å¾ˆå¤šä¸œè¥¿ï¼Œæœ‰ä¸å¯å¿½è§†çš„å­¦ä¹ æˆæœ¬ï¼Œæ¯”å¦‚å„ç§ç”Ÿå‘½å‘¨æœŸï¼ŒthisæŒ‡å‘é—®é¢˜ç­‰ç­‰ï¼Œè€Œæˆ‘ä»¬æ›´å¤šæ—¶å€™éœ€è¦çš„æ˜¯ä¸€ä¸ªè½»å¿«çµæ´»çš„'å¿«è‰‡'

## useState

### 1. åŸºç¡€ä½¿ç”¨

`æœ¬èŠ‚ä»»åŠ¡:` èƒ½å¤Ÿå­¦ä¼šuseStateçš„åŸºç¡€ç”¨æ³•

**ä½œç”¨**

â€‹	useStateä¸ºå‡½æ•°ç»„ä»¶æä¾›çŠ¶æ€ï¼ˆstateï¼‰

**ä½¿ç”¨æ­¥éª¤**

1. å¯¼å…¥ `useState` å‡½æ•°
2. è°ƒç”¨ `useState` å‡½æ•°ï¼Œå¹¶ä¼ å…¥çŠ¶æ€çš„åˆå§‹å€¼
3. ä»`useState`å‡½æ•°çš„è¿”å›å€¼ä¸­ï¼Œæ‹¿åˆ°çŠ¶æ€å’Œä¿®æ”¹çŠ¶æ€çš„æ–¹æ³•
4. åœ¨JSXä¸­å±•ç¤ºçŠ¶æ€
5. è°ƒç”¨ä¿®æ”¹çŠ¶æ€çš„æ–¹æ³•æ›´æ–°çŠ¶æ€

**ä»£ç å®ç°**

```jsx
import { useState } from 'react'

function App() {
  // å‚æ•°ï¼šçŠ¶æ€åˆå§‹å€¼æ¯”å¦‚,ä¼ å…¥ 0 è¡¨ç¤ºè¯¥çŠ¶æ€çš„åˆå§‹å€¼ä¸º 0
  // è¿”å›å€¼ï¼šæ•°ç»„,åŒ…å«ä¸¤ä¸ªå€¼ï¼š1 çŠ¶æ€å€¼ï¼ˆstateï¼‰ 2 ä¿®æ”¹è¯¥çŠ¶æ€çš„å‡½æ•°ï¼ˆsetStateï¼‰
  const [count, setCount] = useState(0)
  return (
    <button onClick={() => { setCount(count + 1) }}>{count}</button>
  )
}
export default App
```

### 2. çŠ¶æ€çš„è¯»å–å’Œä¿®æ”¹

`æœ¬èŠ‚ä»»åŠ¡:` èƒ½å¤Ÿç†è§£useStateä¸‹çŠ¶æ€çš„è¯»å–å’Œä¿®æ”¹

**è¯»å–çŠ¶æ€**

â€‹	è¯¥æ–¹å¼æä¾›çš„çŠ¶æ€ï¼Œæ˜¯å‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œå¯ä»¥åœ¨å‡½æ•°å†…çš„ä»»æ„ä½ç½®ä½¿ç”¨

**ä¿®æ”¹çŠ¶æ€**

1. setCountæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°è¡¨ç¤º`æœ€æ–°çš„çŠ¶æ€å€¼`
2. è°ƒç”¨è¯¥å‡½æ•°åï¼Œå°†ä½¿ç”¨æ–°å€¼æ›¿æ¢æ—§å€¼
3. ä¿®æ”¹çŠ¶æ€åï¼Œç”±äºçŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œä¼šå¼•èµ·è§†å›¾å˜åŒ–

**æ³¨æ„äº‹é¡¹**

â€‹	ä¿®æ”¹çŠ¶æ€çš„æ—¶å€™ï¼Œä¸€å®šè¦ä½¿ç”¨æ–°çš„çŠ¶æ€æ›¿æ¢æ—§çš„çŠ¶æ€ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹æ—§çš„çŠ¶æ€ï¼Œå°¤å…¶æ˜¯å¼•ç”¨ç±»å‹

### 3. ç»„ä»¶çš„æ›´æ–°è¿‡ç¨‹ 

`æœ¬èŠ‚ä»»åŠ¡:`  èƒ½å¤Ÿç†è§£ä½¿ç”¨hookä¹‹åç»„ä»¶çš„æ›´æ–°æƒ…å†µ

å‡½æ•°ç»„ä»¶ä½¿ç”¨ **useState** hook åçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œä»¥åŠçŠ¶æ€å€¼çš„å˜åŒ– 

- ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“
  1. ä»å¤´å¼€å§‹æ‰§è¡Œè¯¥ç»„ä»¶ä¸­çš„ä»£ç é€»è¾‘
  2. è°ƒç”¨ `useState(0)` å°†ä¼ å…¥çš„å‚æ•°ä½œä¸ºçŠ¶æ€åˆå§‹å€¼ï¼Œå³ï¼š0
  3. æ¸²æŸ“ç»„ä»¶ï¼Œæ­¤æ—¶ï¼Œè·å–åˆ°çš„çŠ¶æ€ count å€¼ä¸ºï¼š 0

- ç»„ä»¶ç¬¬äºŒæ¬¡æ¸²æŸ“
  1. ç‚¹å‡»æŒ‰é’®ï¼Œè°ƒç”¨ `setCount(count + 1)` ä¿®æ”¹çŠ¶æ€ï¼Œå› ä¸ºçŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œæ‰€ä»¥ï¼Œè¯¥ç»„ä»¶ä¼šé‡æ–°æ¸²æŸ“
  2. ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œä¼šå†æ¬¡æ‰§è¡Œè¯¥ç»„ä»¶ä¸­çš„ä»£ç é€»è¾‘
  3. å†æ¬¡è°ƒç”¨ `useState(0)`ï¼Œæ­¤æ—¶ **React å†…éƒ¨ä¼šæ‹¿åˆ°æœ€æ–°çš„çŠ¶æ€å€¼è€Œéåˆå§‹å€¼**ï¼Œæ¯”å¦‚ï¼Œè¯¥æ¡ˆä¾‹ä¸­æœ€æ–°çš„çŠ¶æ€å€¼ä¸º 1
  4. å†æ¬¡æ¸²æŸ“ç»„ä»¶ï¼Œæ­¤æ—¶ï¼Œè·å–åˆ°çš„çŠ¶æ€ count å€¼ä¸ºï¼š1

æ³¨æ„ï¼š**useState çš„åˆå§‹å€¼(å‚æ•°)åªä¼šåœ¨ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ç”Ÿæ•ˆ**ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥åçš„æ¯æ¬¡æ¸²æŸ“ï¼ŒuseState è·å–åˆ°éƒ½æ˜¯æœ€æ–°çš„çŠ¶æ€å€¼ï¼ŒReact ç»„ä»¶ä¼šè®°ä½æ¯æ¬¡æœ€æ–°çš„çŠ¶æ€å€¼

```jsx
import { useState } from 'react'

function App() {
  const [count, setCount] = useState(0)
  // åœ¨è¿™é‡Œå¯ä»¥è¿›è¡Œæ‰“å°æµ‹è¯•
  console.log(count)
  return (
    <button onClick={() => { setCount(count + 1) }}>{count}</button>
  )
}
export default App
```



### 4. ä½¿ç”¨è§„åˆ™

`æœ¬èŠ‚ä»»åŠ¡:`  èƒ½å¤Ÿè®°ä½useStateçš„ä½¿ç”¨è§„åˆ™

1. `useState` å‡½æ•°å¯ä»¥æ‰§è¡Œå¤šæ¬¡ï¼Œæ¯æ¬¡æ‰§è¡Œäº’ç›¸ç‹¬ç«‹ï¼Œæ¯è°ƒç”¨ä¸€æ¬¡ä¸ºå‡½æ•°ç»„ä»¶æä¾›ä¸€ä¸ªçŠ¶æ€

   ```js
   function List(){
     // ä»¥å­—ç¬¦ä¸²ä¸ºåˆå§‹å€¼
     const [name, setName] = useState('cp')
     // ä»¥æ•°ç»„ä¸ºåˆå§‹å€¼
     const [list,setList] = useState([])
   }
   ```

2. `useState` æ³¨æ„äº‹é¡¹

   1. åªèƒ½å‡ºç°åœ¨å‡½æ•°ç»„ä»¶ä¸­

   2. ä¸èƒ½åµŒå¥—åœ¨if/for/å…¶å®ƒå‡½æ•°ä¸­ï¼ˆreactæŒ‰ç…§hooksçš„è°ƒç”¨é¡ºåºè¯†åˆ«æ¯ä¸€ä¸ªhookï¼‰

      ```js
      let num = 1
      function List(){
        num++
        if(num / 2 === 0){
           const [name, setName] = useState('cp') 
        }
        const [list,setList] = useState([])
      }
      // ä¿©ä¸ªhookçš„é¡ºåºä¸æ˜¯å›ºå®šçš„ï¼Œè¿™æ˜¯ä¸å¯ä»¥çš„ï¼ï¼ï¼
      ```

   3. å¯ä»¥é€šè¿‡å¼€å‘è€…å·¥å…·æŸ¥çœ‹hooksçŠ¶æ€

## useEffect

### 1. ç†è§£å‡½æ•°å‰¯ä½œç”¨

`æœ¬èŠ‚ä»»åŠ¡:` èƒ½å¤Ÿç†è§£å‰¯ä½œç”¨çš„æ¦‚å¿µ

**ä»€ä¹ˆæ˜¯å‰¯ä½œç”¨**

â€‹	å‰¯ä½œç”¨æ˜¯ç›¸å¯¹äºä¸»ä½œç”¨æ¥è¯´çš„ï¼Œä¸€ä¸ªå‡½æ•°é™¤äº†ä¸»ä½œç”¨ï¼Œå…¶ä»–çš„ä½œç”¨å°±æ˜¯å‰¯ä½œç”¨ã€‚å¯¹äº React ç»„ä»¶æ¥è¯´ï¼Œ**ä¸»ä½œç”¨å°±æ˜¯æ ¹æ®æ•°æ®ï¼ˆstate/propsï¼‰æ¸²æŸ“ UI**ï¼Œé™¤æ­¤ä¹‹å¤–éƒ½æ˜¯å‰¯ä½œç”¨ï¼ˆæ¯”å¦‚ï¼Œæ‰‹åŠ¨ä¿®æ”¹ DOMï¼‰

**å¸¸è§çš„å‰¯ä½œç”¨**

1. æ•°æ®è¯·æ±‚ ajaxå‘é€
2. æ‰‹åŠ¨ä¿®æ”¹dom
3. localstorageæ“ä½œ

useEffectå‡½æ•°çš„ä½œç”¨å°±æ˜¯ä¸ºreactå‡½æ•°ç»„ä»¶æä¾›å‰¯ä½œç”¨å¤„ç†çš„ï¼

### 2. åŸºç¡€ä½¿ç”¨

`æœ¬èŠ‚ä»»åŠ¡:` èƒ½å¤Ÿå­¦ä¼šuseEffectçš„åŸºç¡€ç”¨æ³•å¹¶ä¸”æŒæ¡é»˜è®¤çš„æ‰§è¡Œæ‰§è¡Œæ—¶æœº

**ä½œç”¨**

â€‹	ä¸ºreactå‡½æ•°ç»„ä»¶æä¾›å‰¯ä½œç”¨å¤„ç†

**ä½¿ç”¨æ­¥éª¤**

1. å¯¼å…¥ `useEffect` å‡½æ•°
2. è°ƒç”¨ `useEffect` å‡½æ•°ï¼Œå¹¶ä¼ å…¥å›è°ƒå‡½æ•°
3. åœ¨å›è°ƒå‡½æ•°ä¸­ç¼–å†™å‰¯ä½œç”¨å¤„ç†ï¼ˆdomæ“ä½œï¼‰
4. ä¿®æ”¹æ•°æ®çŠ¶æ€
5. æ£€æµ‹å‰¯ä½œç”¨æ˜¯å¦ç”Ÿæ•ˆ

**ä»£ç å®ç°**

```jsx
import { useEffect, useState } from 'react'

function App() {
  const [count, setCount] = useState(0)
 
  useEffect(()=>{
    // domæ“ä½œ
    document.title = `å½“å‰å·²ç‚¹å‡»äº†${count}æ¬¡`
  })
  return (
    <button onClick={() => { setCount(count + 1) }}>{count}</button>
  )
}

export default App

```



### 3. ä¾èµ–é¡¹æ§åˆ¶æ‰§è¡Œæ—¶æœº

`æœ¬èŠ‚ä»»åŠ¡:` èƒ½å¤Ÿå­¦ä¼šä½¿ç”¨ä¾èµ–é¡¹æ§åˆ¶å‰¯ä½œç”¨çš„æ‰§è¡Œæ—¶æœº

**1. ä¸æ·»åŠ ä¾èµ–é¡¹**

> ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ‰§è¡Œä¸€æ¬¡ï¼Œä»¥åŠä¸ç®¡æ˜¯å“ªä¸ªçŠ¶æ€æ›´æ”¹å¼•èµ·ç»„ä»¶æ›´æ–°æ—¶éƒ½ä¼šé‡æ–°æ‰§è¡Œ
>
> 1. ç»„ä»¶åˆå§‹æ¸²æŸ“
> 2. ç»„ä»¶æ›´æ–° ï¼ˆä¸ç®¡æ˜¯å“ªä¸ªçŠ¶æ€å¼•èµ·çš„æ›´æ–°ï¼‰

```jsx
useEffect(()=>{
    console.log('å‰¯ä½œç”¨æ‰§è¡Œäº†')
})
```



**2. æ·»åŠ ç©ºæ•°ç»„**

> ç»„ä»¶åªåœ¨é¦–æ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œä¸€æ¬¡

```jsx
useEffect(()=>{
	 console.log('å‰¯ä½œç”¨æ‰§è¡Œäº†')
},[])
```



**3. æ·»åŠ ç‰¹å®šä¾èµ–é¡¹**

> å‰¯ä½œç”¨å‡½æ•°åœ¨é¦–æ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œï¼Œåœ¨ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°æ‰§è¡Œ

```jsx
function App() {  
    const [count, setCount] = useState(0)  
    const [name, setName] = useState('zs') 
    
    useEffect(() => {    
        console.log('å‰¯ä½œç”¨æ‰§è¡Œäº†')  
    }, [count])  
    
    return (    
        <>      
         <button onClick={() => { setCount(count + 1) }}>{count}</button>      
         <button onClick={() => { setName('cp') }}>{name}</button>    
        </>  
    )
}
```

**æ³¨æ„äº‹é¡¹**

useEffect å›è°ƒå‡½æ•°ä¸­ç”¨åˆ°çš„æ•°æ®ï¼ˆæ¯”å¦‚ï¼Œcountï¼‰å°±æ˜¯ä¾èµ–æ•°æ®ï¼Œå°±åº”è¯¥å‡ºç°åœ¨ä¾èµ–é¡¹æ•°ç»„ä¸­ï¼Œå¦‚æœä¸æ·»åŠ ä¾èµ–é¡¹å°±ä¼šæœ‰bugå‡ºç°

## é˜¶æ®µå°ç»ƒä¹  - è‡ªå®šä¹‰hook

**éœ€æ±‚æè¿°**ï¼šè‡ªå®šä¹‰ä¸€ä¸ªhookå‡½æ•°ï¼Œå®ç°è·å–æ»šåŠ¨è·ç¦»Y

> `const [y] = useWindowScroll()`

```js
import { useState } from "react"

export function useWindowScroll () {
  const [y, setY] = useState(0)
  window.addEventListener('scroll', () => {
    const h = document.documentElement.scrollTop
    setY(h)
  })
  return [y]
}
```

**éœ€æ±‚æè¿°ï¼š** è‡ªå®šä¹‰hookå‡½æ•°ï¼Œå¯ä»¥è‡ªåŠ¨åŒæ­¥åˆ°æœ¬åœ°LocalStorage 

> `const [message, setMessage] = useLocalStorage(keyï¼ŒdefaultValue)`
>
> 1. messageå¯ä»¥é€šè¿‡è‡ªå®šä¹‰ä¼ å…¥é»˜è®¤åˆå§‹å€¼
> 2. æ¯æ¬¡ä¿®æ”¹messageæ•°æ®çš„æ—¶å€™ éƒ½ä¼šè‡ªåŠ¨å¾€æœ¬åœ°åŒæ­¥ä¸€ä»½

```js
import { useEffect, useState } from 'react'

export function useLocalStorage (key, defaultValue) {
  const [message, setMessage] = useState(defaultValue)
  // æ¯æ¬¡åªè¦messageå˜åŒ– å°±ä¼šè‡ªåŠ¨åŒæ­¥åˆ°æœ¬åœ°ls
  useEffect(() => {
    window.localStorage.setItem(key, message)
  }, [message, key])
  return [message, setMessage]
} 
```



# Hooksè¿›é˜¶

## useState - å›è°ƒå‡½æ•°çš„å‚æ•°

`æœ¬èŠ‚ä»»åŠ¡:`  èƒ½å¤Ÿç†è§£useStateå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°çš„ä½¿ç”¨åœºæ™¯

**ä½¿ç”¨åœºæ™¯**

å‚æ•°åªä¼šåœ¨ç»„ä»¶çš„åˆå§‹æ¸²æŸ“ä¸­èµ·ä½œç”¨ï¼Œåç»­æ¸²æŸ“æ—¶ä¼šè¢«å¿½ç•¥ã€‚å¦‚æœåˆå§‹ state éœ€è¦é€šè¿‡è®¡ç®—æ‰èƒ½è·å¾—ï¼Œåˆ™å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­è®¡ç®—å¹¶è¿”å›åˆå§‹çš„ stateï¼Œæ­¤å‡½æ•°åªåœ¨åˆå§‹æ¸²æŸ“æ—¶è¢«è°ƒç”¨

**è¯­æ³•**

```jsx
const [name, setName] = useState(()=>{    // ç¼–å†™è®¡ç®—é€»è¾‘    return 'è®¡ç®—ä¹‹åçš„åˆå§‹å€¼'})
```

**è¯­æ³•è§„åˆ™**

1. å›è°ƒå‡½æ•°returnå‡ºå»çš„å€¼å°†ä½œä¸º `name` çš„åˆå§‹å€¼
2. å›è°ƒå‡½æ•°ä¸­çš„é€»è¾‘åªä¼šåœ¨ç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡

**è¯­æ³•é€‰æ‹©**

1. å¦‚æœå°±æ˜¯åˆå§‹åŒ–ä¸€ä¸ªæ™®é€šçš„æ•°æ® ç›´æ¥ä½¿ç”¨ `useState(æ™®é€šæ•°æ®)` å³å¯
2. å¦‚æœè¦åˆå§‹åŒ–çš„æ•°æ®æ— æ³•ç›´æ¥å¾—åˆ°éœ€è¦é€šè¿‡è®¡ç®—æ‰èƒ½è·å–åˆ°ï¼Œä½¿ç”¨`useState(()=>{})` 

**æ¥ä¸ªéœ€æ±‚**

![](assets/state01.png)

```jsx
import { useState } from 'react'

function Counter(props) {
  const [count, setCount] = useState(() => {
    return props.count
  })
  return (
    <div>
      <button onClick={() => setCount(count + 1)}>{count}</button>
    </div>
  )
}

function App() {
  return (
    <>
      <Counter count={10} />
      <Counter count={20} />
    </>
  )
}

export default App
```



## useEffect - æ¸…ç†å‰¯ä½œç”¨

`æœ¬èŠ‚ä»»åŠ¡:`  èƒ½å¤ŸæŒæ¡æ¸…ç†useEffectçš„æ–¹æ³•

**ä½¿ç”¨åœºæ™¯**

åœ¨ç»„ä»¶è¢«é”€æ¯æ—¶ï¼Œå¦‚æœæœ‰äº›å‰¯ä½œç”¨æ“ä½œéœ€è¦è¢«æ¸…ç†ï¼Œå°±å¯ä»¥ä½¿ç”¨æ­¤è¯­æ³•ï¼Œæ¯”å¦‚å¸¸è§çš„å®šæ—¶å™¨ 

**è¯­æ³•åŠè§„åˆ™**

```js
useEffect(() => {   
    console.log('å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œäº†')    
    // å‰¯ä½œç”¨å‡½æ•°çš„æ‰§è¡Œæ—¶æœºä¸º: åœ¨ä¸‹ä¸€æ¬¡å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œä¹‹å‰æ‰§è¡Œ   
    return () => {      
        console.log('æ¸…ç†å‰¯ä½œç”¨çš„å‡½æ•°æ‰§è¡Œäº†')      
        // åœ¨è¿™é‡Œå†™æ¸…ç†å‰¯ä½œç”¨çš„ä»£ç     
    }
})
```

**å®šæ—¶å™¨å°æ¡ˆä¾‹**

> æ·»åŠ å‰¯ä½œç”¨å‡½æ•°å‰ï¼šç»„ä»¶è™½ç„¶å·²ç»ä¸æ˜¾ç¤ºäº†ï¼Œä½†æ˜¯å®šæ—¶å™¨ä¾æ—§åœ¨è¿è¡Œ

```jsx
import { useEffect, useState } from 'react'
function Foo() {  
    useEffect(() => {    
        setInterval(() => {     
            console.log('å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œäº†')    
        }, 1000)  
    }) 
    return <div>Foo</div>  
}


function App() {  
    const [flag, setFlag] = useState(true)  
    return (    
        <>      
          <button onClick={() => setFlag(false)}>click</button>      
         {flag ? <Foo/> : null}    
        </>  
    )
}

export default App
```

> æ·»åŠ æ¸…ç†å‰¯ä½œç”¨å‡½æ•°åï¼šä¸€æ—¦ç»„ä»¶è¢«é”€æ¯ï¼Œå®šæ—¶å™¨ä¹Ÿè¢«æ¸…ç†

```jsx
import { useEffect, useState } from 'react'

function Foo() {  
    useEffect(() => {   
        const timerId = setInterval(() => {      
            console.log('å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œäº†')    
        }, 1000)   
        // æ·»åŠ æ¸…ç†å‰¯ç§Ÿç”¨å‡½æ•°    
        return () => {      
            clearInterval(timerId)    
        }  
    })  
    return <div>Foo</div>
}
function App() {  
    const [flag, setFlag] = useState(true)  
    return (   
        <>      
          <button onClick={() => setFlag(false)}>click</button>      
         {flag ? <Foo/> : null}    
        </>    
    )
}

export default App
```

## useEffect - å‘é€ç½‘ç»œè¯·æ±‚

`æœ¬èŠ‚ä»»åŠ¡:`  èƒ½å¤ŸæŒæ¡ä½¿ç”¨useEffect hookå‘é€ç½‘ç»œè¯·æ±‚

**ä½¿ç”¨åœºæ™¯**

å¦‚ä½•åœ¨useEffectä¸­å‘é€ç½‘ç»œè¯·æ±‚ï¼Œå¹¶ä¸”å°è£…åŒæ­¥ async awaitæ“ä½œ

**è¯­æ³•è¦æ±‚**

ä¸å¯ä»¥ç›´æ¥åœ¨useEffectçš„å›è°ƒå‡½æ•°å¤–å±‚ç›´æ¥åŒ…è£¹ await ï¼Œå› ä¸º**å¼‚æ­¥ä¼šå¯¼è‡´æ¸…ç†å‡½æ•°æ— æ³•ç«‹å³è¿”å›**

```js
useEffect(async ()=>{    
    const res = await axios.get('http://geek.itheima.net/v1_0/channels')   
    console.log(res)
},[])
```

**æ­£ç¡®å†™æ³•**

åœ¨å†…éƒ¨å•ç‹¬å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åæŠŠè¿™ä¸ªå‡½æ•°åŒ…è£…æˆåŒæ­¥

```jsx
useEffect(()=>{   
    async function fetchData(){      
       const res = await axios.get('http://geek.itheima.net/v1_0/channels')                            console.log(res)   
    } 
},[])
```

## useRef

`æœ¬èŠ‚ä»»åŠ¡:`  èƒ½å¤ŸæŒæ¡ä½¿ç”¨useRefè·å–çœŸå®domæˆ–ç»„ä»¶å®ä¾‹çš„æ–¹æ³•

**ä½¿ç”¨åœºæ™¯**

åœ¨å‡½æ•°ç»„ä»¶ä¸­è·å–çœŸå®çš„domå…ƒç´ å¯¹è±¡æˆ–è€…æ˜¯ç»„ä»¶å¯¹è±¡

**ä½¿ç”¨æ­¥éª¤**

1. å¯¼å…¥ `useRef` å‡½æ•°
2. æ‰§è¡Œ `useRef` å‡½æ•°å¹¶ä¼ å…¥nullï¼Œè¿”å›å€¼ä¸ºä¸€ä¸ªå¯¹è±¡ å†…éƒ¨æœ‰ä¸€ä¸ªcurrentå±æ€§å­˜æ”¾æ‹¿åˆ°çš„domå¯¹è±¡ï¼ˆç»„ä»¶å®ä¾‹ï¼‰
3. é€šè¿‡ref ç»‘å®š è¦è·å–çš„å…ƒç´ æˆ–è€…ç»„ä»¶

**è·å–dom**

```jsx
import { useEffect, useRef } from 'react'
function App() {  
    const h1Ref = useRef(null)  
    useEffect(() => {    
        console.log(h1Ref)  
    },[])  
    return (    
        <div>      
            <h1 ref={ h1Ref }>this is h1</h1>    
        </div>  
    )
}
export default App
```

**è·å–ç»„ä»¶å®ä¾‹**

> å‡½æ•°ç»„ä»¶ç”±äºæ²¡æœ‰å®ä¾‹ï¼Œä¸èƒ½ä½¿ç”¨refè·å–ï¼Œå¦‚æœæƒ³è·å–ç»„ä»¶å®ä¾‹ï¼Œå¿…é¡»æ˜¯ç±»ç»„ä»¶

`Foo.js`

```jsx
class Foo extends React.Component {  
    sayHi = () => {    
        console.log('say hi')  
    }  
    render(){    
        return <div>Foo</div>  
    }
}
    
export default Foo
```

`App.js`

```jsx
import { useEffect, useRef } from 'react'
import Foo from './Foo'
function App() {  
    const h1Foo = useRef(null)  
    useEffect(() => {    
        console.log(h1Foo)  
    }, [])  
    return (    
        <div> <Foo ref={ h1Foo } /></div>  
    )
}
export default App
```

## useContext

`æœ¬èŠ‚ä»»åŠ¡:`  èƒ½å¤ŸæŒæ¡hooksä¸‹çš„contextä½¿ç”¨æ–¹å¼

![](D:/reactè¯¾ç¨‹å…¨ç³»åˆ—/è¯¾ç¨‹è®²ä¹‰åŠèµ„æº/è¯¾ç¨‹è®²ä¹‰/1.ReactåŸºç¡€è¯¾/assets/context.png)

**å®ç°æ­¥éª¤**

1. ä½¿ç”¨`createContext` åˆ›å»ºContextå¯¹è±¡
2. åœ¨é¡¶å±‚ç»„ä»¶é€šè¿‡`Provider` æä¾›æ•°æ®
3. åœ¨åº•å±‚ç»„ä»¶é€šè¿‡`useContext`å‡½æ•°è·å–æ•°æ®

**ä»£ç å®ç°**

```jsx
import { createContext, useContext } from 'react'
// åˆ›å»ºContextå¯¹è±¡
const Context = createContext()

function Foo() {  
    return <div>Foo <Bar/></div>
}

function Bar() {  
    // åº•å±‚ç»„ä»¶é€šè¿‡useContextå‡½æ•°è·å–æ•°æ®  
    const name = useContext(Context)  
    return <div>Bar {name}</div>
}

function App() {  
    return (    
        // é¡¶å±‚ç»„ä»¶é€šè¿‡Provider æä¾›æ•°æ®    
        <Context.Provider value={'this is name'}>     
            <div><Foo/></div>    
        </Context.Provider>  
    )
}

export default App
```

## é˜¶æ®µå°ç»ƒä¹ -todoMvc-hookç‰ˆ

æ¡ˆä¾‹ä»“åº“åœ°å€ï¼šhttps://gitee.com/react-course-series/react-tomvc-hook

**é¡¹ç›®æ¼”ç¤ºæ­¥éª¤ï¼š**

1. å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°

   ```bash
   git clone  https://gitee.com/react-course-series/react-tomvc-hook.git
   ```

2. å®‰è£…å¿…è¦ä¾èµ–

   ```bash
   yarn
   ```

3. å¼€å¯mockæ¥å£æœåŠ¡ï¼Œ**ä¿æŒçª—å£ä¸å…³é—­**  ï¼ï¼ï¼ï¼ï¼

   ```bash
   # å¯åŠ¨mockæœåŠ¡
   yarn mock-serve
   ```

4. **å¦èµ·ä¸€ä¸ªbashçª—å£**å¼€å¯å‰ç«¯æœåŠ¡

   ```bash
   yarn start
   ```

5. æµè§ˆå™¨è¾“å…¥ localhost:3000æ¼”ç¤ºæ•ˆæœ

**é¡¹ç›®å¼€å‘æ­¥éª¤ï¼š**

1. åˆ‡æ¢åˆ°todo-teståˆ†æ”¯

   ```bash
   git checkout todo-test
   ```

2. æ‰“å¼€ app.js

   å·²æœ‰åŸºç¡€æ ·æ¿ä»£ç ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šç¼–å†™ä¸šåŠ¡é€»è¾‘å³å¯

3. æ¥å£æ–‡æ¡£

   | æ¥å£ä½œç”¨ | æ¥å£åœ°å€                              | æ¥å£æ–¹æ³• | æ¥å£å‚æ•°               |
   | -------- | ------------------------------------- | -------- | ---------------------- |
   | è·å–åˆ—è¡¨ | http://localhost:3001/data            | GET      | æ—                      |
   | åˆ é™¤     | http://localhost:3001/data/:id        | DELETE   | id                     |
   | æœç´¢     | http://localhost:3001/data/?q=keyword | GET      | nameï¼ˆä»¥nameå­—æ®µæœç´¢ï¼‰ |

**å®ç°åŠŸèƒ½**

| åŠŸèƒ½         | æ ¸å¿ƒæ€è·¯                             |
| ------------ | ------------------------------------ |
| è¡¨æ ¼æ•°æ®æ¸²æŸ“ | elementPlus el-tableç»„ä»¶ä½¿ç”¨         |
| åˆ é™¤åŠŸèƒ½     | è·å–å½“å‰id  è°ƒç”¨æ¥å£                 |
| æœç´¢åŠŸèƒ½     | ç”¨çš„ä¾æ—§æ˜¯åˆ—è¡¨æ¥å£ï¼Œå¤šä¼ ä¸€ä¸ªnameå‚æ•° |
| æ¸…é™¤æœç´¢åŠŸèƒ½ | æ¸…ç©ºæœç´¢å‚æ•°  é‡æ–°è·å–åˆ—è¡¨           |

 
